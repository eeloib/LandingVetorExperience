<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sistema Limpa Rio Comunidade</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://unpkg.com/docx@8.5.0/build/index.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>
    <style>
        body {
            box-sizing: border-box;
        }
        
        .fade-in {
            animation: fadeIn 0.3s ease-in;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .slide-in {
            animation: slideIn 0.3s ease-out;
        }
        
        @keyframes slideIn {
            from { transform: translateX(-100%); }
            to { transform: translateX(0); }
        }
        
        .photo-preview {
            transition: all 0.3s ease;
        }
        
        .photo-preview:hover {
            transform: scale(1.05);
        }
        
        .form-section {
            border-left: 4px solid #3b82f6;
            background: linear-gradient(135deg, #f8fafc 0%, #f1f5f9 100%);
        }
        
        .btn-primary {
            background: linear-gradient(135deg, #3b82f6 0%, #1d4ed8 100%);
            transition: all 0.3s ease;
        }
        
        .btn-primary:hover {
            background: linear-gradient(135deg, #1d4ed8 0%, #1e40af 100%);
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(59, 130, 246, 0.4);
        }
        
        .sidebar {
            background: linear-gradient(180deg, #1e40af 0%, #3730a3 100%);
        }
        
        .card {
            background: white;
            border-radius: 12px;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
            transition: all 0.3s ease;
        }
        
        .card:hover {
            box-shadow: 0 10px 25px -3px rgba(0, 0, 0, 0.1);
        }
        
        .input-field {
            transition: all 0.3s ease;
        }
        
        .input-field:focus {
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(59, 130, 246, 0.2);
        }
    </style>
</head>
<body class="bg-gray-50 min-h-full">
    <!-- Header -->
    <header class="bg-white shadow-lg border-b-4 border-blue-600">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between items-center py-4">
                <div class="flex items-center space-x-4">
                    <div class="w-12 h-12 bg-gradient-to-br from-blue-600 to-blue-800 rounded-lg flex items-center justify-center">
                        <span class="text-white font-bold text-xl">üåä</span>
                    </div>
                    <div>
                        <h1 class="text-2xl font-bold text-gray-900">Limpa Rio Comunidade</h1>
                        <p class="text-sm text-gray-600">Sistema de Reconhecimento S√≥cio Territorial</p>
                    </div>
                </div>
                <div class="flex items-center space-x-4">
                    <span class="text-sm text-gray-600" id="currentUser">Usu√°rio: Jo√£o Silva</span>
                    <button onclick="logout()" class="text-red-600 hover:text-red-800 text-sm font-medium">Sair</button>
                </div>
            </div>
        </div>
    </header>

    <div class="flex h-full">
        <!-- Sidebar -->
        <nav class="sidebar w-64 min-h-full p-6 hidden lg:block">
            <ul class="space-y-3">
                <li><button onclick="showSection('dashboard')" class="nav-btn w-full text-left text-white hover:bg-white hover:bg-opacity-20 px-4 py-3 rounded-lg transition-all">üìä Dashboard</button></li>
                <li><button onclick="showSection('nova-frente')" class="nav-btn w-full text-left text-white hover:bg-white hover:bg-opacity-20 px-4 py-3 rounded-lg transition-all">‚ûï Nova Frente</button></li>
                <li><button onclick="showSection('listar-frentes')" class="nav-btn w-full text-left text-white hover:bg-white hover:bg-opacity-20 px-4 py-3 rounded-lg transition-all">üìã Listar Frentes</button></li>
                <li><button onclick="showSection('relatorios')" class="nav-btn w-full text-left text-white hover:bg-white hover:bg-opacity-20 px-4 py-3 rounded-lg transition-all">üìà Relat√≥rios</button></li>
                <li><button onclick="showSection('usuarios')" class="nav-btn w-full text-left text-white hover:bg-white hover:bg-opacity-20 px-4 py-3 rounded-lg transition-all">üë• Usu√°rios</button></li>
            </ul>
        </nav>

        <!-- Mobile Menu Button -->
        <div class="lg:hidden fixed top-4 left-4 z-50">
            <button onclick="toggleMobileMenu()" class="bg-blue-600 text-white p-2 rounded-lg">
                <span id="menuIcon">‚ò∞</span>
            </button>
        </div>

        <!-- Mobile Menu -->
        <div id="mobileMenu" class="lg:hidden fixed inset-0 bg-black bg-opacity-50 z-40 hidden">
            <nav class="sidebar w-64 h-full p-6">
                <ul class="space-y-3 mt-16">
                    <li><button onclick="showSection('dashboard'); toggleMobileMenu()" class="w-full text-left text-white hover:bg-white hover:bg-opacity-20 px-4 py-3 rounded-lg transition-all">üìä Dashboard</button></li>
                    <li><button onclick="showSection('nova-frente'); toggleMobileMenu()" class="w-full text-left text-white hover:bg-white hover:bg-opacity-20 px-4 py-3 rounded-lg transition-all">‚ûï Nova Frente</button></li>
                    <li><button onclick="showSection('listar-frentes'); toggleMobileMenu()" class="w-full text-left text-white hover:bg-white hover:bg-opacity-20 px-4 py-3 rounded-lg transition-all">üìã Listar Frentes</button></li>
                    <li><button onclick="showSection('relatorios'); toggleMobileMenu()" class="w-full text-left text-white hover:bg-white hover:bg-opacity-20 px-4 py-3 rounded-lg transition-all">üìà Relat√≥rios</button></li>
                    <li><button onclick="showSection('usuarios'); toggleMobileMenu()" class="w-full text-left text-white hover:bg-white hover:bg-opacity-20 px-4 py-3 rounded-lg transition-all">üë• Usu√°rios</button></li>
                </ul>
            </nav>
        </div>

        <!-- Main Content -->
        <main class="flex-1 p-4 lg:p-8 lg:ml-0 ml-0">
            <!-- Dashboard Section -->
            <div id="dashboard" class="section fade-in">
                <h2 class="text-3xl font-bold text-gray-900 mb-8">Dashboard</h2>
                
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
                    <div class="card p-6">
                        <div class="flex items-center">
                            <div class="w-12 h-12 bg-blue-100 rounded-lg flex items-center justify-center">
                                <span class="text-2xl">üèûÔ∏è</span>
                            </div>
                            <div class="ml-4">
                                <p class="text-sm font-medium text-gray-600">Frentes Cadastradas</p>
                                <p class="text-2xl font-bold text-gray-900" id="totalFrentes">24</p>
                            </div>
                        </div>
                    </div>
                    
                    <div class="card p-6">
                        <div class="flex items-center">
                            <div class="w-12 h-12 bg-green-100 rounded-lg flex items-center justify-center">
                                <span class="text-2xl">üèòÔ∏è</span>
                            </div>
                            <div class="ml-4">
                                <p class="text-sm font-medium text-gray-600">Comunidades Mapeadas</p>
                                <p class="text-2xl font-bold text-gray-900" id="totalComunidades">18</p>
                            </div>
                        </div>
                    </div>
                    
                    <div class="card p-6">
                        <div class="flex items-center">
                            <div class="w-12 h-12 bg-purple-100 rounded-lg flex items-center justify-center">
                                <span class="text-2xl">üè´</span>
                            </div>
                            <div class="ml-4">
                                <p class="text-sm font-medium text-gray-600">Equipamentos P√∫blicos</p>
                                <p class="text-2xl font-bold text-gray-900" id="totalEquipamentos">142</p>
                            </div>
                        </div>
                    </div>
                    
                    <div class="card p-6">
                        <div class="flex items-center">
                            <div class="w-12 h-12 bg-orange-100 rounded-lg flex items-center justify-center">
                                <span class="text-2xl">üìä</span>
                            </div>
                            <div class="ml-4">
                                <p class="text-sm font-medium text-gray-600">Relat√≥rios Gerados</p>
                                <p class="text-2xl font-bold text-gray-900" id="totalRelatorios">8</p>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
                    <div class="card p-6">
                        <h3 class="text-xl font-bold text-gray-900 mb-4">√öltimas Frentes Cadastradas</h3>
                        <div class="space-y-4" id="ultimasFrentes">
                            <div class="flex justify-between items-center p-3 bg-gray-50 rounded-lg">
                                <div>
                                    <p class="font-medium">Frente 166 - Rio Acari</p>
                                    <p class="text-sm text-gray-600">Bangu - 15/01/2024</p>
                                </div>
                                <span class="px-2 py-1 bg-green-100 text-green-800 text-xs rounded-full">Conclu√≠do</span>
                            </div>
                            <div class="flex justify-between items-center p-3 bg-gray-50 rounded-lg">
                                <div>
                                    <p class="font-medium">Frente 167 - Rio Pavuna</p>
                                    <p class="text-sm text-gray-600">Pavuna - 14/01/2024</p>
                                </div>
                                <span class="px-2 py-1 bg-yellow-100 text-yellow-800 text-xs rounded-full">Em andamento</span>
                            </div>
                        </div>
                    </div>
                    
                    <div class="card p-6">
                        <h3 class="text-xl font-bold text-gray-900 mb-4">A√ß√µes R√°pidas</h3>
                        <div class="space-y-3">
                            <button onclick="showSection('nova-frente')" class="btn-primary w-full text-white px-4 py-3 rounded-lg font-medium">
                                ‚ûï Cadastrar Nova Frente
                            </button>
                            <button onclick="exportarDados()" class="w-full bg-green-600 hover:bg-green-700 text-white px-4 py-3 rounded-lg font-medium transition-all">
                                üìä Exportar Dados
                            </button>
                            <button onclick="gerarRelatorio()" class="w-full bg-purple-600 hover:bg-purple-700 text-white px-4 py-3 rounded-lg font-medium transition-all">
                                üìÑ Gerar Relat√≥rio
                            </button>
                            <button onclick="importarCSV()" class="w-full bg-orange-600 hover:bg-orange-700 text-white px-4 py-3 rounded-lg font-medium transition-all">
                                üì• Importar CSV
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Nova Frente Section -->
            <div id="nova-frente" class="section hidden">
                <h2 class="text-3xl font-bold text-gray-900 mb-8">Cadastrar Nova Frente de Trabalho</h2>
                
                <form id="frenteForm" class="space-y-8">
                    <!-- Dados B√°sicos -->
                    <div class="form-section p-6 rounded-lg">
                        <h3 class="text-xl font-bold text-gray-900 mb-6">üìã Dados B√°sicos da Frente</h3>
                        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">C√≥digo da Frente</label>
                                <input type="text" name="codigo" class="input-field w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" placeholder="Ex: 166" required>
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Nome do Corpo H√≠drico</label>
                                <input type="text" name="corpoHidrico" class="input-field w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" placeholder="Ex: Rio Acari" required>
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Data da Visita</label>
                                <input type="date" name="dataVisita" class="input-field w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" required>
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Bairro/Localidade</label>
                                <input type="text" name="bairro" class="input-field w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" placeholder="Ex: Bangu" required>
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Munic√≠pio</label>
                                <select name="municipio" class="input-field w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" required>
                                    <option value="">Selecione o munic√≠pio</option>
                                    <option value="Rio de Janeiro">Rio de Janeiro</option>
                                    <option value="Niter√≥i">Niter√≥i</option>
                                    <option value="S√£o Gon√ßalo">S√£o Gon√ßalo</option>
                                    <option value="Duque de Caxias">Duque de Caxias</option>
                                </select>
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Regi√£o Hidrogr√°fica</label>
                                <select name="regiaoHidrografica" class="input-field w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" required>
                                    <option value="">Selecione a regi√£o</option>
                                    <option value="Ba√≠a de Guanabara">Ba√≠a de Guanabara</option>
                                    <option value="Ba√≠a de Sepetiba">Ba√≠a de Sepetiba</option>
                                    <option value="Lagoa Rodrigo de Freitas">Lagoa Rodrigo de Freitas</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- Equipe -->
                    <div class="form-section p-6 rounded-lg">
                        <h3 class="text-xl font-bold text-gray-900 mb-6">üë• Identifica√ß√£o da Equipe</h3>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">T√©cnica Social</label>
                                <input type="text" name="tecnicaSocial" class="input-field w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" placeholder="Nome da t√©cnica social" required>
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Encarregados</label>
                                <input type="text" name="encarregados" class="input-field w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" placeholder="Nomes dos encarregados">
                            </div>
                            <div class="md:col-span-2">
                                <label class="block text-sm font-medium text-gray-700 mb-2">Agentes Socioambientais</label>
                                <textarea name="agentesSocioambientais" rows="3" class="input-field w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" placeholder="Liste os agentes socioambientais"></textarea>
                            </div>
                        </div>
                    </div>

                    <!-- Caracteriza√ß√£o da √Årea -->
                    <div class="form-section p-6 rounded-lg">
                        <h3 class="text-xl font-bold text-gray-900 mb-6">üèòÔ∏è Caracteriza√ß√£o da √Årea</h3>
                        <div class="space-y-6">
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">H√° comunidade no entorno?</label>
                                    <select name="comunidadeEntorno" class="input-field w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" onchange="toggleComunidadeFields(this.value)">
                                        <option value="">Selecione</option>
                                        <option value="sim">Sim</option>
                                        <option value="nao">N√£o</option>
                                    </select>
                                </div>
                                <div id="nomeComunidadeDiv" class="hidden">
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Nome da Comunidade</label>
                                    <input type="text" name="nomeComunidade" class="input-field w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" placeholder="Nome da comunidade">
                                </div>
                            </div>
                            
                            <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Constru√ß√µes √†s margens?</label>
                                    <select name="construcoesMargens" class="input-field w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" onchange="toggleConstrucoesFields(this.value)">
                                        <option value="">Selecione</option>
                                        <option value="sim">Sim</option>
                                        <option value="nao">N√£o</option>
                                    </select>
                                </div>
                                <div id="tipoConstrucaoDiv" class="hidden">
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Tipo de Constru√ß√£o</label>
                                    <select name="tipoConstrucao" class="input-field w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                                        <option value="">Selecione</option>
                                        <option value="alvenaria">Alvenaria</option>
                                        <option value="taipa">Taipa</option>
                                        <option value="madeira">Madeira</option>
                                        <option value="outros">Outros</option>
                                    </select>
                                </div>
                                <div id="quantidadeMoradiasDiv" class="hidden">
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Quantidade de Moradias</label>
                                    <input type="number" name="quantidadeMoradias" class="input-field w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" placeholder="0">
                                </div>
                            </div>
                            
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Observa√ß√µes Gerais</label>
                                <textarea name="observacoesGerais" rows="4" class="input-field w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" placeholder="Descreva caracter√≠sticas da √°rea (rural/urbana, polui√ß√£o, dist√¢ncia, coleta de lixo, transporte, etc.)"></textarea>
                            </div>
                        </div>
                    </div>

                    <!-- Equipamentos P√∫blicos -->
                    <div class="form-section p-6 rounded-lg">
                        <h3 class="text-xl font-bold text-gray-900 mb-6">üè´ Levantamento de Equipamentos P√∫blicos</h3>
                        
                        <div class="space-y-8">
                            <!-- Escolas -->
                            <div>
                                <h4 class="text-lg font-semibold text-gray-800 mb-4">üéì Escolas</h4>
                                <div id="escolasContainer">
                                    <div class="escola-item p-4 bg-white rounded-lg border mb-4">
                                        <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-4">
                                            <input type="text" name="escola_nome[]" class="input-field px-3 py-2 border border-gray-300 rounded-lg" placeholder="Nome da escola">
                                            <input type="text" name="escola_endereco[]" class="input-field px-3 py-2 border border-gray-300 rounded-lg" placeholder="Endere√ßo">
                                            <select name="escola_segmento[]" class="input-field px-3 py-2 border border-gray-300 rounded-lg">
                                                <option value="">Segmento</option>
                                                <option value="infantil">Educa√ß√£o Infantil</option>
                                                <option value="fundamental">Ensino Fundamental</option>
                                                <option value="medio">Ensino M√©dio</option>
                                            </select>
                                        </div>
                                        <div class="border-t pt-4">
                                            <label class="block text-sm font-medium text-gray-700 mb-2">üì∏ Fotos da Escola</label>
                                            <div class="flex items-center space-x-4">
                                                <input type="file" class="escola-photos hidden" multiple accept="image/*" onchange="handleEquipamentoPhotoUpload(event, 'escola', this)">
                                                <button type="button" onclick="this.previousElementSibling.click()" class="bg-blue-100 hover:bg-blue-200 text-blue-700 px-4 py-2 rounded-lg text-sm font-medium transition-all">
                                                    üì∑ Adicionar Fotos
                                                </button>
                                                <span class="text-sm text-gray-600">Selecione m√∫ltiplas imagens</span>
                                            </div>
                                            <div class="escola-preview grid grid-cols-3 md:grid-cols-6 gap-2 mt-3"></div>
                                        </div>
                                    </div>
                                </div>
                                <button type="button" onclick="addEquipamento('escolas')" class="text-blue-600 hover:text-blue-800 font-medium">+ Adicionar Escola</button>
                            </div>

                            <!-- Unidades de Sa√∫de -->
                            <div>
                                <h4 class="text-lg font-semibold text-gray-800 mb-4">üè• Unidades de Sa√∫de</h4>
                                <div id="saudeContainer">
                                    <div class="saude-item p-4 bg-white rounded-lg border mb-4">
                                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
                                            <input type="text" name="saude_nome[]" class="input-field px-3 py-2 border border-gray-300 rounded-lg" placeholder="Nome da unidade">
                                            <input type="text" name="saude_endereco[]" class="input-field px-3 py-2 border border-gray-300 rounded-lg" placeholder="Endere√ßo">
                                        </div>
                                        <div class="border-t pt-4">
                                            <label class="block text-sm font-medium text-gray-700 mb-2">üì∏ Fotos da Unidade de Sa√∫de</label>
                                            <div class="flex items-center space-x-4">
                                                <input type="file" class="saude-photos hidden" multiple accept="image/*" onchange="handleEquipamentoPhotoUpload(event, 'saude', this)">
                                                <button type="button" onclick="this.previousElementSibling.click()" class="bg-green-100 hover:bg-green-200 text-green-700 px-4 py-2 rounded-lg text-sm font-medium transition-all">
                                                    üì∑ Adicionar Fotos
                                                </button>
                                                <span class="text-sm text-gray-600">Selecione m√∫ltiplas imagens</span>
                                            </div>
                                            <div class="saude-preview grid grid-cols-3 md:grid-cols-6 gap-2 mt-3"></div>
                                        </div>
                                    </div>
                                </div>
                                <button type="button" onclick="addEquipamento('saude')" class="text-blue-600 hover:text-blue-800 font-medium">+ Adicionar Unidade de Sa√∫de</button>
                            </div>

                            <!-- Transporte P√∫blico -->
                            <div>
                                <h4 class="text-lg font-semibold text-gray-800 mb-4">üöå Transporte P√∫blico</h4>
                                <div id="transporteContainer">
                                    <div class="transporte-item p-4 bg-white rounded-lg border mb-4">
                                        <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-4">
                                            <input type="text" name="transporte_linha[]" class="input-field px-3 py-2 border border-gray-300 rounded-lg" placeholder="Linha/N√∫mero">
                                            <input type="text" name="transporte_empresa[]" class="input-field px-3 py-2 border border-gray-300 rounded-lg" placeholder="Empresa">
                                            <select name="transporte_tipo[]" class="input-field px-3 py-2 border border-gray-300 rounded-lg">
                                                <option value="">Tipo</option>
                                                <option value="onibus">√înibus</option>
                                                <option value="van">Van</option>
                                                <option value="metro">Metr√¥</option>
                                                <option value="trem">Trem</option>
                                            </select>
                                        </div>
                                        <div class="border-t pt-4">
                                            <label class="block text-sm font-medium text-gray-700 mb-2">üì∏ Fotos do Transporte</label>
                                            <div class="flex items-center space-x-4">
                                                <input type="file" class="transporte-photos hidden" multiple accept="image/*" onchange="handleEquipamentoPhotoUpload(event, 'transporte', this)">
                                                <button type="button" onclick="this.previousElementSibling.click()" class="bg-purple-100 hover:bg-purple-200 text-purple-700 px-4 py-2 rounded-lg text-sm font-medium transition-all">
                                                    üì∑ Adicionar Fotos
                                                </button>
                                                <span class="text-sm text-gray-600">Selecione m√∫ltiplas imagens</span>
                                            </div>
                                            <div class="transporte-preview grid grid-cols-3 md:grid-cols-6 gap-2 mt-3"></div>
                                        </div>
                                    </div>
                                </div>
                                <button type="button" onclick="addEquipamento('transporte')" class="text-blue-600 hover:text-blue-800 font-medium">+ Adicionar Transporte</button>
                            </div>

                            <!-- √Åreas de Lazer -->
                            <div>
                                <h4 class="text-lg font-semibold text-gray-800 mb-4">üèûÔ∏è √Åreas de Lazer</h4>
                                <div id="lazerContainer">
                                    <div class="lazer-item p-4 bg-white rounded-lg border mb-4">
                                        <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-4">
                                            <input type="text" name="lazer_nome[]" class="input-field px-3 py-2 border border-gray-300 rounded-lg" placeholder="Nome do local">
                                            <input type="text" name="lazer_endereco[]" class="input-field px-3 py-2 border border-gray-300 rounded-lg" placeholder="Endere√ßo">
                                            <input type="text" name="lazer_descricao[]" class="input-field px-3 py-2 border border-gray-300 rounded-lg" placeholder="Descri√ß√£o">
                                        </div>
                                        <div class="border-t pt-4">
                                            <label class="block text-sm font-medium text-gray-700 mb-2">üì∏ Fotos da √Årea de Lazer</label>
                                            <div class="flex items-center space-x-4">
                                                <input type="file" class="lazer-photos hidden" multiple accept="image/*" onchange="handleEquipamentoPhotoUpload(event, 'lazer', this)">
                                                <button type="button" onclick="this.previousElementSibling.click()" class="bg-orange-100 hover:bg-orange-200 text-orange-700 px-4 py-2 rounded-lg text-sm font-medium transition-all">
                                                    üì∑ Adicionar Fotos
                                                </button>
                                                <span class="text-sm text-gray-600">Selecione m√∫ltiplas imagens</span>
                                            </div>
                                            <div class="lazer-preview grid grid-cols-3 md:grid-cols-6 gap-2 mt-3"></div>
                                        </div>
                                    </div>
                                </div>
                                <button type="button" onclick="addEquipamento('lazer')" class="text-blue-600 hover:text-blue-800 font-medium">+ Adicionar √Årea de Lazer</button>
                            </div>

                            <!-- Institui√ß√µes Religiosas -->
                            <div>
                                <h4 class="text-lg font-semibold text-gray-800 mb-4">‚õ™ Institui√ß√µes Religiosas</h4>
                                <div id="religiosasContainer">
                                    <div class="religiosas-item p-4 bg-white rounded-lg border mb-4">
                                        <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-4">
                                            <input type="text" name="religiosas_nome[]" class="input-field px-3 py-2 border border-gray-300 rounded-lg" placeholder="Nome da institui√ß√£o">
                                            <input type="text" name="religiosas_endereco[]" class="input-field px-3 py-2 border border-gray-300 rounded-lg" placeholder="Endere√ßo">
                                            <select name="religiosas_tipo[]" class="input-field px-3 py-2 border border-gray-300 rounded-lg">
                                                <option value="">Tipo</option>
                                                <option value="igreja">Igreja</option>
                                                <option value="templo">Templo</option>
                                                <option value="centro">Centro Esp√≠rita</option>
                                                <option value="outros">Outros</option>
                                            </select>
                                        </div>
                                        <div class="border-t pt-4">
                                            <label class="block text-sm font-medium text-gray-700 mb-2">üì∏ Fotos da Institui√ß√£o Religiosa</label>
                                            <div class="flex items-center space-x-4">
                                                <input type="file" class="religiosas-photos hidden" multiple accept="image/*" onchange="handleEquipamentoPhotoUpload(event, 'religiosas', this)">
                                                <button type="button" onclick="this.previousElementSibling.click()" class="bg-indigo-100 hover:bg-indigo-200 text-indigo-700 px-4 py-2 rounded-lg text-sm font-medium transition-all">
                                                    üì∑ Adicionar Fotos
                                                </button>
                                                <span class="text-sm text-gray-600">Selecione m√∫ltiplas imagens</span>
                                            </div>
                                            <div class="religiosas-preview grid grid-cols-3 md:grid-cols-6 gap-2 mt-3"></div>
                                        </div>
                                    </div>
                                </div>
                                <button type="button" onclick="addEquipamento('religiosas')" class="text-blue-600 hover:text-blue-800 font-medium">+ Adicionar Institui√ß√£o Religiosa</button>
                            </div>

                            <!-- Associa√ß√µes de Moradores -->
                            <div>
                                <h4 class="text-lg font-semibold text-gray-800 mb-4">üèòÔ∏è Associa√ß√µes de Moradores</h4>
                                <div id="associacoesContainer">
                                    <div class="associacoes-item p-4 bg-white rounded-lg border mb-4">
                                        <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-4">
                                            <input type="text" name="associacoes_nome[]" class="input-field px-3 py-2 border border-gray-300 rounded-lg" placeholder="Nome da associa√ß√£o">
                                            <input type="text" name="associacoes_endereco[]" class="input-field px-3 py-2 border border-gray-300 rounded-lg" placeholder="Endere√ßo">
                                            <input type="text" name="associacoes_contato[]" class="input-field px-3 py-2 border border-gray-300 rounded-lg" placeholder="Contato">
                                        </div>
                                        <div class="border-t pt-4">
                                            <label class="block text-sm font-medium text-gray-700 mb-2">üì∏ Fotos da Associa√ß√£o</label>
                                            <div class="flex items-center space-x-4">
                                                <input type="file" class="associacoes-photos hidden" multiple accept="image/*" onchange="handleEquipamentoPhotoUpload(event, 'associacoes', this)">
                                                <button type="button" onclick="this.previousElementSibling.click()" class="bg-teal-100 hover:bg-teal-200 text-teal-700 px-4 py-2 rounded-lg text-sm font-medium transition-all">
                                                    üì∑ Adicionar Fotos
                                                </button>
                                                <span class="text-sm text-gray-600">Selecione m√∫ltiplas imagens</span>
                                            </div>
                                            <div class="associacoes-preview grid grid-cols-3 md:grid-cols-6 gap-2 mt-3"></div>
                                        </div>
                                    </div>
                                </div>
                                <button type="button" onclick="addEquipamento('associacoes')" class="text-blue-600 hover:text-blue-800 font-medium">+ Adicionar Associa√ß√£o</button>
                            </div>

                            <!-- Com√©rcios Locais -->
                            <div>
                                <h4 class="text-lg font-semibold text-gray-800 mb-4">üè™ Com√©rcios Locais</h4>
                                <div id="comerciosContainer">
                                    <div class="comercios-item p-4 bg-white rounded-lg border mb-4">
                                        <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-4">
                                            <input type="text" name="comercios_nome[]" class="input-field px-3 py-2 border border-gray-300 rounded-lg" placeholder="Nome do com√©rcio">
                                            <input type="text" name="comercios_endereco[]" class="input-field px-3 py-2 border border-gray-300 rounded-lg" placeholder="Endere√ßo">
                                            <select name="comercios_tipo[]" class="input-field px-3 py-2 border border-gray-300 rounded-lg">
                                                <option value="">Tipo</option>
                                                <option value="mercado">Mercado</option>
                                                <option value="farmacia">Farm√°cia</option>
                                                <option value="padaria">Padaria</option>
                                                <option value="restaurante">Restaurante</option>
                                                <option value="outros">Outros</option>
                                            </select>
                                        </div>
                                        <div class="border-t pt-4">
                                            <label class="block text-sm font-medium text-gray-700 mb-2">üì∏ Fotos do Com√©rcio</label>
                                            <div class="flex items-center space-x-4">
                                                <input type="file" class="comercios-photos hidden" multiple accept="image/*" onchange="handleEquipamentoPhotoUpload(event, 'comercios', this)">
                                                <button type="button" onclick="this.previousElementSibling.click()" class="bg-yellow-100 hover:bg-yellow-200 text-yellow-700 px-4 py-2 rounded-lg text-sm font-medium transition-all">
                                                    üì∑ Adicionar Fotos
                                                </button>
                                                <span class="text-sm text-gray-600">Selecione m√∫ltiplas imagens</span>
                                            </div>
                                            <div class="comercios-preview grid grid-cols-3 md:grid-cols-6 gap-2 mt-3"></div>
                                        </div>
                                    </div>
                                </div>
                                <button type="button" onclick="addEquipamento('comercios')" class="text-blue-600 hover:text-blue-800 font-medium">+ Adicionar Com√©rcio</button>
                            </div>
                        </div>
                    </div>

                    <!-- Upload de Fotos -->
                    <div class="form-section p-6 rounded-lg">
                        <h3 class="text-xl font-bold text-gray-900 mb-6">üì∏ Upload de Fotos</h3>
                        <div class="space-y-4">
                            <div class="border-2 border-dashed border-gray-300 rounded-lg p-8 text-center">
                                <input type="file" id="photoUpload" multiple accept="image/*" class="hidden" onchange="handlePhotoUpload(event)">
                                <button type="button" onclick="document.getElementById('photoUpload').click()" class="btn-primary text-white px-6 py-3 rounded-lg font-medium">
                                    üì∑ Selecionar Fotos
                                </button>
                                <p class="text-sm text-gray-600 mt-2">Selecione m√∫ltiplas imagens (JPG, PNG)</p>
                            </div>
                            <div id="photoPreview" class="grid grid-cols-2 md:grid-cols-4 gap-4"></div>
                        </div>
                    </div>

                    <!-- Bot√µes de A√ß√£o -->
                    <div class="flex flex-col sm:flex-row gap-4 pt-6">
                        <button type="submit" class="btn-primary text-white px-8 py-3 rounded-lg font-medium flex-1">
                            üíæ Salvar Frente de Trabalho
                        </button>
                        <button type="button" onclick="exportarFrenteAtual()" class="bg-green-600 hover:bg-green-700 text-white px-8 py-3 rounded-lg font-medium transition-all">
                            üìä Exportar CSV
                        </button>
                        <button type="button" onclick="gerarWordFrenteAtual()" class="bg-blue-600 hover:bg-blue-700 text-white px-8 py-3 rounded-lg font-medium transition-all">
                            üìÑ Gerar Word
                        </button>
                        <button type="button" onclick="limparFormulario()" class="bg-gray-600 hover:bg-gray-700 text-white px-8 py-3 rounded-lg font-medium transition-all">
                            üóëÔ∏è Limpar Formul√°rio
                        </button>
                    </div>
                </form>
            </div>

            <!-- Listar Frentes Section -->
            <div id="listar-frentes" class="section hidden">
                <h2 class="text-3xl font-bold text-gray-900 mb-8">üìã Frentes Cadastradas</h2>
                
                <!-- Filtros -->
                <div class="card p-6 mb-8">
                    <h3 class="text-lg font-semibold text-gray-800 mb-4">üîç Filtros</h3>
                    <div class="grid grid-cols-1 md:grid-cols-4 gap-4">
                        <input type="text" id="filtroMunicipio" placeholder="Munic√≠pio" class="input-field px-4 py-2 border border-gray-300 rounded-lg">
                        <input type="date" id="filtroData" class="input-field px-4 py-2 border border-gray-300 rounded-lg">
                        <input type="text" id="filtroAgente" placeholder="Agente" class="input-field px-4 py-2 border border-gray-300 rounded-lg">
                        <button onclick="aplicarFiltros()" class="btn-primary text-white px-4 py-2 rounded-lg font-medium">Filtrar</button>
                    </div>
                </div>

                <!-- Lista de Frentes -->
                <div class="card">
                    <div class="overflow-x-auto">
                        <table class="w-full">
                            <thead class="bg-gray-50">
                                <tr>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">C√≥digo</th>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Corpo H√≠drico</th>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Munic√≠pio</th>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Data</th>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Status</th>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">A√ß√µes</th>
                                </tr>
                            </thead>
                            <tbody id="frentesTableBody" class="bg-white divide-y divide-gray-200">
                                <!-- Dados ser√£o inseridos aqui via JavaScript -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- Relat√≥rios Section -->
            <div id="relatorios" class="section hidden">
                <h2 class="text-3xl font-bold text-gray-900 mb-8">üìà Relat√≥rios e An√°lises</h2>
                
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
                    <div class="card p-6">
                        <h3 class="text-xl font-bold text-gray-900 mb-4">üìä Gerar Relat√≥rios</h3>
                        <div class="space-y-4">
                            <button onclick="gerarRelatorioPDF()" class="w-full bg-red-600 hover:bg-red-700 text-white px-4 py-3 rounded-lg font-medium transition-all">
                                üìÑ Relat√≥rio Completo (PDF)
                            </button>
                            <button onclick="exportarExcel()" class="w-full bg-green-600 hover:bg-green-700 text-white px-4 py-3 rounded-lg font-medium transition-all">
                                üìä Exportar para Excel
                            </button>
                            <button onclick="gerarRelatorioSintese()" class="w-full bg-blue-600 hover:bg-blue-700 text-white px-4 py-3 rounded-lg font-medium transition-all">
                                üìã Relat√≥rio de S√≠ntese
                            </button>
                        </div>
                    </div>
                    
                    <div class="card p-6">
                        <h3 class="text-xl font-bold text-gray-900 mb-4">üìà Estat√≠sticas</h3>
                        <div class="space-y-4">
                            <div class="flex justify-between">
                                <span class="text-gray-600">Total de Frentes:</span>
                                <span class="font-bold">24</span>
                            </div>
                            <div class="flex justify-between">
                                <span class="text-gray-600">Comunidades Identificadas:</span>
                                <span class="font-bold">18</span>
                            </div>
                            <div class="flex justify-between">
                                <span class="text-gray-600">Equipamentos Mapeados:</span>
                                <span class="font-bold">142</span>
                            </div>
                            <div class="flex justify-between">
                                <span class="text-gray-600">Fotos Coletadas:</span>
                                <span class="font-bold">356</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Usu√°rios Section -->
            <div id="usuarios" class="section hidden">
                <h2 class="text-3xl font-bold text-gray-900 mb-8">üë• Gerenciamento de Usu√°rios</h2>
                
                <div class="card p-6 mb-8">
                    <h3 class="text-lg font-semibold text-gray-800 mb-4">‚ûï Adicionar Usu√°rio</h3>
                    <form id="usuarioForm" class="grid grid-cols-1 md:grid-cols-3 gap-4">
                        <input type="text" name="nomeUsuario" placeholder="Nome completo" class="input-field px-4 py-2 border border-gray-300 rounded-lg" required>
                        <input type="email" name="emailUsuario" placeholder="E-mail" class="input-field px-4 py-2 border border-gray-300 rounded-lg" required>
                        <select name="perfilUsuario" class="input-field px-4 py-2 border border-gray-300 rounded-lg" required>
                            <option value="">Selecione o perfil</option>
                            <option value="tecnico">T√©cnico</option>
                            <option value="encarregado">Encarregado</option>
                            <option value="administrador">Administrador</option>
                        </select>
                        <button type="submit" class="btn-primary text-white px-4 py-2 rounded-lg font-medium md:col-span-3">Adicionar Usu√°rio</button>
                    </form>
                </div>

                <div class="card">
                    <div class="overflow-x-auto">
                        <table class="w-full">
                            <thead class="bg-gray-50">
                                <tr>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Nome</th>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">E-mail</th>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Perfil</th>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Status</th>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">A√ß√µes</th>
                                </tr>
                            </thead>
                            <tbody id="usuariosTableBody" class="bg-white divide-y divide-gray-200">
                                <!-- Dados ser√£o inseridos aqui via JavaScript -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <script>
        // Dados simulados
        let frentes = [
            {
                id: 1,
                codigo: '166',
                corpoHidrico: 'Rio Acari',
                municipio: 'Rio de Janeiro',
                bairro: 'Bangu',
                dataVisita: '2024-01-15',
                status: 'Conclu√≠do',
                tecnicaSocial: 'Maria Silva',
                comunidadeEntorno: 'sim',
                nomeComunidade: 'Vila Acari'
            },
            {
                id: 2,
                codigo: '167',
                corpoHidrico: 'Rio Pavuna',
                municipio: 'Rio de Janeiro',
                bairro: 'Pavuna',
                dataVisita: '2024-01-14',
                status: 'Em andamento',
                tecnicaSocial: 'Jo√£o Santos',
                comunidadeEntorno: 'sim',
                nomeComunidade: 'Comunidade da Pavuna'
            }
        ];

        let usuarios = [
            {
                id: 1,
                nome: 'Jo√£o Silva',
                email: 'joao.silva@limpa.rio',
                perfil: 'Administrador',
                status: 'Ativo'
            },
            {
                id: 2,
                nome: 'Maria Santos',
                email: 'maria.santos@limpa.rio',
                perfil: 'T√©cnico',
                status: 'Ativo'
            }
        ];

        let uploadedPhotos = [];

        // Navega√ß√£o
        function showSection(sectionId) {
            document.querySelectorAll('.section').forEach(section => {
                section.classList.add('hidden');
            });
            document.getElementById(sectionId).classList.remove('hidden');
            document.getElementById(sectionId).classList.add('fade-in');
            
            // Atualizar dados quando necess√°rio
            if (sectionId === 'listar-frentes') {
                atualizarTabelaFrente();
            } else if (sectionId === 'usuarios') {
                atualizarTabelaUsuarios();
            }
        }

        function toggleMobileMenu() {
            const menu = document.getElementById('mobileMenu');
            const icon = document.getElementById('menuIcon');
            
            if (menu.classList.contains('hidden')) {
                menu.classList.remove('hidden');
                icon.textContent = '‚úï';
            } else {
                menu.classList.add('hidden');
                icon.textContent = '‚ò∞';
            }
        }

        // Formul√°rio de frente
        function toggleComunidadeFields(value) {
            const div = document.getElementById('nomeComunidadeDiv');
            if (value === 'sim') {
                div.classList.remove('hidden');
            } else {
                div.classList.add('hidden');
            }
        }

        function toggleConstrucoesFields(value) {
            const tipoDiv = document.getElementById('tipoConstrucaoDiv');
            const quantDiv = document.getElementById('quantidadeMoradiasDiv');
            
            if (value === 'sim') {
                tipoDiv.classList.remove('hidden');
                quantDiv.classList.remove('hidden');
            } else {
                tipoDiv.classList.add('hidden');
                quantDiv.classList.add('hidden');
            }
        }

        function addEquipamento(tipo) {
            const container = document.getElementById(tipo + 'Container');
            let template = '';
            
            if (tipo === 'escolas') {
                template = `
                    <div class="escola-item p-4 bg-white rounded-lg border mb-4">
                        <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-4">
                            <input type="text" name="escola_nome[]" class="input-field px-3 py-2 border border-gray-300 rounded-lg" placeholder="Nome da escola">
                            <input type="text" name="escola_endereco[]" class="input-field px-3 py-2 border border-gray-300 rounded-lg" placeholder="Endere√ßo">
                            <select name="escola_segmento[]" class="input-field px-3 py-2 border border-gray-300 rounded-lg">
                                <option value="">Segmento</option>
                                <option value="infantil">Educa√ß√£o Infantil</option>
                                <option value="fundamental">Ensino Fundamental</option>
                                <option value="medio">Ensino M√©dio</option>
                            </select>
                        </div>
                        <div class="border-t pt-4">
                            <label class="block text-sm font-medium text-gray-700 mb-2">üì∏ Fotos da Escola</label>
                            <div class="flex items-center space-x-4">
                                <input type="file" class="escola-photos hidden" multiple accept="image/*" onchange="handleEquipamentoPhotoUpload(event, 'escola', this)">
                                <button type="button" onclick="this.previousElementSibling.click()" class="bg-blue-100 hover:bg-blue-200 text-blue-700 px-4 py-2 rounded-lg text-sm font-medium transition-all">
                                    üì∑ Adicionar Fotos
                                </button>
                                <span class="text-sm text-gray-600">Selecione m√∫ltiplas imagens</span>
                            </div>
                            <div class="escola-preview grid grid-cols-3 md:grid-cols-6 gap-2 mt-3"></div>
                        </div>
                        <button type="button" onclick="this.parentElement.remove()" class="text-red-600 hover:text-red-800 text-sm mt-4">üóëÔ∏è Remover Escola</button>
                    </div>
                `;
            } else if (tipo === 'saude') {
                template = `
                    <div class="saude-item p-4 bg-white rounded-lg border mb-4">
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
                            <input type="text" name="saude_nome[]" class="input-field px-3 py-2 border border-gray-300 rounded-lg" placeholder="Nome da unidade">
                            <input type="text" name="saude_endereco[]" class="input-field px-3 py-2 border border-gray-300 rounded-lg" placeholder="Endere√ßo">
                        </div>
                        <div class="border-t pt-4">
                            <label class="block text-sm font-medium text-gray-700 mb-2">üì∏ Fotos da Unidade de Sa√∫de</label>
                            <div class="flex items-center space-x-4">
                                <input type="file" class="saude-photos hidden" multiple accept="image/*" onchange="handleEquipamentoPhotoUpload(event, 'saude', this)">
                                <button type="button" onclick="this.previousElementSibling.click()" class="bg-green-100 hover:bg-green-200 text-green-700 px-4 py-2 rounded-lg text-sm font-medium transition-all">
                                    üì∑ Adicionar Fotos
                                </button>
                                <span class="text-sm text-gray-600">Selecione m√∫ltiplas imagens</span>
                            </div>
                            <div class="saude-preview grid grid-cols-3 md:grid-cols-6 gap-2 mt-3"></div>
                        </div>
                        <button type="button" onclick="this.parentElement.remove()" class="text-red-600 hover:text-red-800 text-sm mt-4">üóëÔ∏è Remover Unidade</button>
                    </div>
                `;
            } else if (tipo === 'transporte') {
                template = `
                    <div class="transporte-item p-4 bg-white rounded-lg border mb-4">
                        <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-4">
                            <input type="text" name="transporte_linha[]" class="input-field px-3 py-2 border border-gray-300 rounded-lg" placeholder="Linha/N√∫mero">
                            <input type="text" name="transporte_empresa[]" class="input-field px-3 py-2 border border-gray-300 rounded-lg" placeholder="Empresa">
                            <select name="transporte_tipo[]" class="input-field px-3 py-2 border border-gray-300 rounded-lg">
                                <option value="">Tipo</option>
                                <option value="onibus">√înibus</option>
                                <option value="van">Van</option>
                                <option value="metro">Metr√¥</option>
                                <option value="trem">Trem</option>
                            </select>
                        </div>
                        <div class="border-t pt-4">
                            <label class="block text-sm font-medium text-gray-700 mb-2">üì∏ Fotos do Transporte</label>
                            <div class="flex items-center space-x-4">
                                <input type="file" class="transporte-photos hidden" multiple accept="image/*" onchange="handleEquipamentoPhotoUpload(event, 'transporte', this)">
                                <button type="button" onclick="this.previousElementSibling.click()" class="bg-purple-100 hover:bg-purple-200 text-purple-700 px-4 py-2 rounded-lg text-sm font-medium transition-all">
                                    üì∑ Adicionar Fotos
                                </button>
                                <span class="text-sm text-gray-600">Selecione m√∫ltiplas imagens</span>
                            </div>
                            <div class="transporte-preview grid grid-cols-3 md:grid-cols-6 gap-2 mt-3"></div>
                        </div>
                        <button type="button" onclick="this.parentElement.remove()" class="text-red-600 hover:text-red-800 text-sm mt-4">üóëÔ∏è Remover Transporte</button>
                    </div>
                `;
            } else if (tipo === 'lazer') {
                template = `
                    <div class="lazer-item p-4 bg-white rounded-lg border mb-4">
                        <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-4">
                            <input type="text" name="lazer_nome[]" class="input-field px-3 py-2 border border-gray-300 rounded-lg" placeholder="Nome do local">
                            <input type="text" name="lazer_endereco[]" class="input-field px-3 py-2 border border-gray-300 rounded-lg" placeholder="Endere√ßo">
                            <input type="text" name="lazer_descricao[]" class="input-field px-3 py-2 border border-gray-300 rounded-lg" placeholder="Descri√ß√£o">
                        </div>
                        <div class="border-t pt-4">
                            <label class="block text-sm font-medium text-gray-700 mb-2">üì∏ Fotos da √Årea de Lazer</label>
                            <div class="flex items-center space-x-4">
                                <input type="file" class="lazer-photos hidden" multiple accept="image/*" onchange="handleEquipamentoPhotoUpload(event, 'lazer', this)">
                                <button type="button" onclick="this.previousElementSibling.click()" class="bg-orange-100 hover:bg-orange-200 text-orange-700 px-4 py-2 rounded-lg text-sm font-medium transition-all">
                                    üì∑ Adicionar Fotos
                                </button>
                                <span class="text-sm text-gray-600">Selecione m√∫ltiplas imagens</span>
                            </div>
                            <div class="lazer-preview grid grid-cols-3 md:grid-cols-6 gap-2 mt-3"></div>
                        </div>
                        <button type="button" onclick="this.parentElement.remove()" class="text-red-600 hover:text-red-800 text-sm mt-4">üóëÔ∏è Remover √Årea de Lazer</button>
                    </div>
                `;
            } else if (tipo === 'religiosas') {
                template = `
                    <div class="religiosas-item p-4 bg-white rounded-lg border mb-4">
                        <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-4">
                            <input type="text" name="religiosas_nome[]" class="input-field px-3 py-2 border border-gray-300 rounded-lg" placeholder="Nome da institui√ß√£o">
                            <input type="text" name="religiosas_endereco[]" class="input-field px-3 py-2 border border-gray-300 rounded-lg" placeholder="Endere√ßo">
                            <select name="religiosas_tipo[]" class="input-field px-3 py-2 border border-gray-300 rounded-lg">
                                <option value="">Tipo</option>
                                <option value="igreja">Igreja</option>
                                <option value="templo">Templo</option>
                                <option value="centro">Centro Esp√≠rita</option>
                                <option value="outros">Outros</option>
                            </select>
                        </div>
                        <div class="border-t pt-4">
                            <label class="block text-sm font-medium text-gray-700 mb-2">üì∏ Fotos da Institui√ß√£o Religiosa</label>
                            <div class="flex items-center space-x-4">
                                <input type="file" class="religiosas-photos hidden" multiple accept="image/*" onchange="handleEquipamentoPhotoUpload(event, 'religiosas', this)">
                                <button type="button" onclick="this.previousElementSibling.click()" class="bg-indigo-100 hover:bg-indigo-200 text-indigo-700 px-4 py-2 rounded-lg text-sm font-medium transition-all">
                                    üì∑ Adicionar Fotos
                                </button>
                                <span class="text-sm text-gray-600">Selecione m√∫ltiplas imagens</span>
                            </div>
                            <div class="religiosas-preview grid grid-cols-3 md:grid-cols-6 gap-2 mt-3"></div>
                        </div>
                        <button type="button" onclick="this.parentElement.remove()" class="text-red-600 hover:text-red-800 text-sm mt-4">üóëÔ∏è Remover Institui√ß√£o</button>
                    </div>
                `;
            } else if (tipo === 'associacoes') {
                template = `
                    <div class="associacoes-item p-4 bg-white rounded-lg border mb-4">
                        <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-4">
                            <input type="text" name="associacoes_nome[]" class="input-field px-3 py-2 border border-gray-300 rounded-lg" placeholder="Nome da associa√ß√£o">
                            <input type="text" name="associacoes_endereco[]" class="input-field px-3 py-2 border border-gray-300 rounded-lg" placeholder="Endere√ßo">
                            <input type="text" name="associacoes_contato[]" class="input-field px-3 py-2 border border-gray-300 rounded-lg" placeholder="Contato">
                        </div>
                        <div class="border-t pt-4">
                            <label class="block text-sm font-medium text-gray-700 mb-2">üì∏ Fotos da Associa√ß√£o</label>
                            <div class="flex items-center space-x-4">
                                <input type="file" class="associacoes-photos hidden" multiple accept="image/*" onchange="handleEquipamentoPhotoUpload(event, 'associacoes', this)">
                                <button type="button" onclick="this.previousElementSibling.click()" class="bg-teal-100 hover:bg-teal-200 text-teal-700 px-4 py-2 rounded-lg text-sm font-medium transition-all">
                                    üì∑ Adicionar Fotos
                                </button>
                                <span class="text-sm text-gray-600">Selecione m√∫ltiplas imagens</span>
                            </div>
                            <div class="associacoes-preview grid grid-cols-3 md:grid-cols-6 gap-2 mt-3"></div>
                        </div>
                        <button type="button" onclick="this.parentElement.remove()" class="text-red-600 hover:text-red-800 text-sm mt-4">üóëÔ∏è Remover Associa√ß√£o</button>
                    </div>
                `;
            } else if (tipo === 'comercios') {
                template = `
                    <div class="comercios-item p-4 bg-white rounded-lg border mb-4">
                        <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-4">
                            <input type="text" name="comercios_nome[]" class="input-field px-3 py-2 border border-gray-300 rounded-lg" placeholder="Nome do com√©rcio">
                            <input type="text" name="comercios_endereco[]" class="input-field px-3 py-2 border border-gray-300 rounded-lg" placeholder="Endere√ßo">
                            <select name="comercios_tipo[]" class="input-field px-3 py-2 border border-gray-300 rounded-lg">
                                <option value="">Tipo</option>
                                <option value="mercado">Mercado</option>
                                <option value="farmacia">Farm√°cia</option>
                                <option value="padaria">Padaria</option>
                                <option value="restaurante">Restaurante</option>
                                <option value="outros">Outros</option>
                            </select>
                        </div>
                        <div class="border-t pt-4">
                            <label class="block text-sm font-medium text-gray-700 mb-2">üì∏ Fotos do Com√©rcio</label>
                            <div class="flex items-center space-x-4">
                                <input type="file" class="comercios-photos hidden" multiple accept="image/*" onchange="handleEquipamentoPhotoUpload(event, 'comercios', this)">
                                <button type="button" onclick="this.previousElementSibling.click()" class="bg-yellow-100 hover:bg-yellow-200 text-yellow-700 px-4 py-2 rounded-lg text-sm font-medium transition-all">
                                    üì∑ Adicionar Fotos
                                </button>
                                <span class="text-sm text-gray-600">Selecione m√∫ltiplas imagens</span>
                            </div>
                            <div class="comercios-preview grid grid-cols-3 md:grid-cols-6 gap-2 mt-3"></div>
                        </div>
                        <button type="button" onclick="this.parentElement.remove()" class="text-red-600 hover:text-red-800 text-sm mt-4">üóëÔ∏è Remover Com√©rcio</button>
                    </div>
                `;
            }
            
            container.insertAdjacentHTML('beforeend', template);
        }

        function handlePhotoUpload(event) {
            const files = event.target.files;
            const preview = document.getElementById('photoPreview');
            
            for (let file of files) {
                if (file.type.startsWith('image/')) {
                    const reader = new FileReader();
                    reader.onload = function(e) {
                        const photoDiv = document.createElement('div');
                        photoDiv.className = 'photo-preview relative';
                        photoDiv.innerHTML = `
                            <img src="${e.target.result}" class="w-full h-32 object-cover rounded-lg">
                            <button type="button" onclick="this.parentElement.remove()" class="absolute top-2 right-2 bg-red-600 text-white rounded-full w-6 h-6 flex items-center justify-center text-xs">√ó</button>
                            <p class="text-xs text-gray-600 mt-1">${file.name}</p>
                        `;
                        preview.appendChild(photoDiv);
                        
                        uploadedPhotos.push({
                            name: file.name,
                            data: e.target.result,
                            date: new Date().toISOString()
                        });
                    };
                    reader.readAsDataURL(file);
                }
            }
        }

        function handleEquipamentoPhotoUpload(event, tipo, inputElement) {
            const files = event.target.files;
            const equipamentoItem = inputElement.closest(`.${tipo}-item`);
            const preview = equipamentoItem.querySelector(`.${tipo}-preview`);
            
            for (let file of files) {
                if (file.type.startsWith('image/')) {
                    const reader = new FileReader();
                    reader.onload = function(e) {
                        const photoDiv = document.createElement('div');
                        photoDiv.className = 'photo-preview relative';
                        photoDiv.innerHTML = `
                            <img src="${e.target.result}" class="w-full h-20 object-cover rounded-lg">
                            <button type="button" onclick="this.parentElement.remove()" class="absolute top-1 right-1 bg-red-600 text-white rounded-full w-5 h-5 flex items-center justify-center text-xs">√ó</button>
                        `;
                        preview.appendChild(photoDiv);
                        
                        // Armazenar foto com refer√™ncia ao equipamento
                        if (!equipamentoItem.equipamentoPhotos) {
                            equipamentoItem.equipamentoPhotos = [];
                        }
                        equipamentoItem.equipamentoPhotos.push({
                            name: file.name,
                            data: e.target.result,
                            date: new Date().toISOString(),
                            tipo: tipo
                        });
                    };
                    reader.readAsDataURL(file);
                }
            }
        }

        function limparFormulario() {
            if (confirm('Tem certeza que deseja limpar todos os dados do formul√°rio?')) {
                document.getElementById('frenteForm').reset();
                document.getElementById('photoPreview').innerHTML = '';
                uploadedPhotos = [];
                
                // Esconder campos condicionais
                document.getElementById('nomeComunidadeDiv').classList.add('hidden');
                document.getElementById('tipoConstrucaoDiv').classList.add('hidden');
                document.getElementById('quantidadeMoradiasDiv').classList.add('hidden');
            }
        }

        // Fun√ß√µes de gera√ß√£o de documentos
        async function gerarPDFFrente(frente, formData) {
            try {
                const { jsPDF } = window.jspdf;
                const doc = new jsPDF();
                
                // Configurar fonte
                doc.setFont('helvetica');
                
                // T√≠tulo
                doc.setFontSize(20);
                doc.setTextColor(59, 130, 246);
                doc.text('SISTEMA LIMPA RIO COMUNIDADE', 20, 20);
                
                doc.setFontSize(16);
                doc.setTextColor(0, 0, 0);
                doc.text('Relat√≥rio de Frente de Trabalho', 20, 35);
                
                // Linha separadora
                doc.setDrawColor(59, 130, 246);
                doc.setLineWidth(0.5);
                doc.line(20, 40, 190, 40);
                
                let yPos = 55;
                
                // Dados b√°sicos
                doc.setFontSize(14);
                doc.setTextColor(59, 130, 246);
                doc.text('DADOS B√ÅSICOS', 20, yPos);
                yPos += 10;
                
                doc.setFontSize(11);
                doc.setTextColor(0, 0, 0);
                doc.text(`C√≥digo da Frente: ${frente.codigo}`, 20, yPos);
                yPos += 7;
                doc.text(`Corpo H√≠drico: ${frente.corpoHidrico}`, 20, yPos);
                yPos += 7;
                doc.text(`Munic√≠pio: ${frente.municipio}`, 20, yPos);
                yPos += 7;
                doc.text(`Bairro: ${frente.bairro}`, 20, yPos);
                yPos += 7;
                doc.text(`Data da Visita: ${new Date(frente.dataVisita).toLocaleDateString('pt-BR')}`, 20, yPos);
                yPos += 7;
                doc.text(`Regi√£o Hidrogr√°fica: ${formData.get('regiaoHidrografica') || 'N√£o informado'}`, 20, yPos);
                yPos += 15;
                
                // Equipe
                doc.setFontSize(14);
                doc.setTextColor(59, 130, 246);
                doc.text('EQUIPE', 20, yPos);
                yPos += 10;
                
                doc.setFontSize(11);
                doc.setTextColor(0, 0, 0);
                doc.text(`T√©cnica Social: ${frente.tecnicaSocial}`, 20, yPos);
                yPos += 7;
                doc.text(`Encarregados: ${formData.get('encarregados') || 'N√£o informado'}`, 20, yPos);
                yPos += 7;
                
                const agentes = formData.get('agentesSocioambientais');
                if (agentes) {
                    doc.text('Agentes Socioambientais:', 20, yPos);
                    yPos += 7;
                    const linhasAgentes = doc.splitTextToSize(agentes, 170);
                    doc.text(linhasAgentes, 25, yPos);
                    yPos += linhasAgentes.length * 7 + 8;
                }
                
                // Caracteriza√ß√£o da √°rea
                doc.setFontSize(14);
                doc.setTextColor(59, 130, 246);
                doc.text('CARACTERIZA√á√ÉO DA √ÅREA', 20, yPos);
                yPos += 10;
                
                doc.setFontSize(11);
                doc.setTextColor(0, 0, 0);
                doc.text(`Comunidade no entorno: ${frente.comunidadeEntorno === 'sim' ? 'Sim' : 'N√£o'}`, 20, yPos);
                yPos += 7;
                
                if (frente.nomeComunidade) {
                    doc.text(`Nome da Comunidade: ${frente.nomeComunidade}`, 20, yPos);
                    yPos += 7;
                }
                
                doc.text(`Constru√ß√µes √†s margens: ${formData.get('construcoesMargens') === 'sim' ? 'Sim' : 'N√£o'}`, 20, yPos);
                yPos += 7;
                
                if (formData.get('tipoConstrucao')) {
                    doc.text(`Tipo de Constru√ß√£o: ${formData.get('tipoConstrucao')}`, 20, yPos);
                    yPos += 7;
                }
                
                if (formData.get('quantidadeMoradias')) {
                    doc.text(`Quantidade de Moradias: ${formData.get('quantidadeMoradias')}`, 20, yPos);
                    yPos += 7;
                }
                
                const observacoes = formData.get('observacoesGerais');
                if (observacoes) {
                    yPos += 5;
                    doc.text('Observa√ß√µes Gerais:', 20, yPos);
                    yPos += 7;
                    const linhasObs = doc.splitTextToSize(observacoes, 170);
                    doc.text(linhasObs, 25, yPos);
                    yPos += linhasObs.length * 7;
                }
                
                // Nova p√°gina para equipamentos se necess√°rio
                if (yPos > 250) {
                    doc.addPage();
                    yPos = 20;
                }
                
                // Equipamentos p√∫blicos detalhados
                yPos += 15;
                doc.setFontSize(14);
                doc.setTextColor(59, 130, 246);
                doc.text('EQUIPAMENTOS P√öBLICOS IDENTIFICADOS', 20, yPos);
                yPos += 15;
                
                // Coletar dados detalhados dos equipamentos
                const equipamentos = await coletarDadosEquipamentos(formData);
                
                // Adicionar cada tipo de equipamento com detalhes
                for (const [tipo, dados] of Object.entries(equipamentos)) {
                    if (dados.length > 0) {
                        // Verificar se precisa de nova p√°gina
                        if (yPos > 250) {
                            doc.addPage();
                            yPos = 20;
                        }
                        
                        const tipoTitulos = {
                            escolas: "ESCOLAS",
                            saude: "UNIDADES DE SA√öDE", 
                            transporte: "TRANSPORTE P√öBLICO",
                            lazer: "√ÅREAS DE LAZER",
                            religiosas: "INSTITUI√á√ïES RELIGIOSAS",
                            associacoes: "ASSOCIA√á√ïES DE MORADORES",
                            comercios: "COM√âRCIOS LOCAIS"
                        };

                        doc.setFontSize(12);
                        doc.setTextColor(0, 150, 100);
                        doc.text(tipoTitulos[tipo], 20, yPos);
                        yPos += 10;

                        doc.setFontSize(10);
                        doc.setTextColor(0, 0, 0);

                        dados.forEach((item, index) => {
                            // Verificar espa√ßo na p√°gina
                            if (yPos > 270) {
                                doc.addPage();
                                yPos = 20;
                            }

                            // Nome do equipamento
                            doc.setFont('helvetica', 'bold');
                            doc.text(`${index + 1}. ${item.nome || item.linha || 'N√£o informado'}`, 25, yPos);
                            yPos += 6;

                            doc.setFont('helvetica', 'normal');
                            
                            // Detalhes espec√≠ficos
                            if (item.endereco) {
                                doc.text(`   Endere√ßo: ${item.endereco}`, 25, yPos);
                                yPos += 5;
                            }
                            if (item.segmento) {
                                doc.text(`   Segmento: ${item.segmento}`, 25, yPos);
                                yPos += 5;
                            }
                            if (item.empresa) {
                                doc.text(`   Empresa: ${item.empresa}`, 25, yPos);
                                yPos += 5;
                            }
                            if (item.tipo) {
                                doc.text(`   Tipo: ${item.tipo}`, 25, yPos);
                                yPos += 5;
                            }
                            if (item.descricao) {
                                doc.text(`   Descri√ß√£o: ${item.descricao}`, 25, yPos);
                                yPos += 5;
                            }
                            if (item.contato) {
                                doc.text(`   Contato: ${item.contato}`, 25, yPos);
                                yPos += 5;
                            }

                            // Adicionar fotos se houver
                            if (item.fotos && item.fotos.length > 0) {
                                doc.setFont('helvetica', 'italic');
                                doc.text(`   Fotos: ${item.fotos.length} imagem(ns) anexada(s)`, 25, yPos);
                                yPos += 5;
                                doc.setFont('helvetica', 'normal');

                                // Adicionar at√© 2 fotos por equipamento no PDF
                                for (let i = 0; i < Math.min(2, item.fotos.length); i++) {
                                    try {
                                        if (yPos > 200) {
                                            doc.addPage();
                                            yPos = 20;
                                        }

                                        const foto = item.fotos[i];
                                        doc.addImage(foto.data, 'JPEG', 25, yPos, 60, 40);
                                        yPos += 45;
                                    } catch (error) {
                                        console.warn('Erro ao adicionar foto ao PDF:', error);
                                    }
                                }
                            }

                            yPos += 5; // Espa√ßo entre equipamentos
                        });

                        yPos += 10; // Espa√ßo entre tipos de equipamentos
                    }
                }

                // Fotos gerais
                if (uploadedPhotos.length > 0) {
                    if (yPos > 200) {
                        doc.addPage();
                        yPos = 20;
                    }

                    doc.setFontSize(14);
                    doc.setTextColor(59, 130, 246);
                    doc.text('FOTOS GERAIS DA FRENTE', 20, yPos);
                    yPos += 15;

                    // Adicionar at√© 4 fotos gerais
                    for (let i = 0; i < Math.min(4, uploadedPhotos.length); i++) {
                        try {
                            if (yPos > 200) {
                                doc.addPage();
                                yPos = 20;
                            }

                            const foto = uploadedPhotos[i];
                            doc.addImage(foto.data, 'JPEG', 20, yPos, 80, 60);
                            
                            // Nome da foto
                            doc.setFontSize(8);
                            doc.setTextColor(100, 100, 100);
                            doc.text(foto.name, 20, yPos + 65);
                            
                            yPos += 75;
                        } catch (error) {
                            console.warn('Erro ao adicionar foto geral ao PDF:', error);
                        }
                    }
                }
                
                // Rodap√© na √∫ltima p√°gina
                const totalPages = doc.internal.getNumberOfPages();
                for (let i = 1; i <= totalPages; i++) {
                    doc.setPage(i);
                    doc.setFontSize(8);
                    doc.setTextColor(128, 128, 128);
                    doc.text(`P√°gina ${i} de ${totalPages}`, 170, 285);
                    if (i === totalPages) {
                        doc.text(`Relat√≥rio gerado em ${new Date().toLocaleDateString('pt-BR')} √†s ${new Date().toLocaleTimeString('pt-BR')}`, 20, 280);
                        doc.text('Sistema Limpa Rio Comunidade - Reconhecimento S√≥cio Territorial', 20, 285);
                    }
                }
                
                // Salvar PDF
                doc.save(`Frente_${frente.codigo}_${frente.corpoHidrico.replace(/\s+/g, '_')}.pdf`);
                
            } catch (error) {
                console.error('Erro ao gerar PDF:', error);
                alert('Erro ao gerar PDF. Verifique os dados e tente novamente.');
            }
        }
        
        async function gerarWordFrente(frente, formData) {
            try {
                // Mostrar indicador de processamento
                const processingDiv = document.createElement('div');
                processingDiv.className = 'fixed top-4 right-4 bg-blue-600 text-white px-6 py-3 rounded-lg shadow-lg z-50';
                processingDiv.innerHTML = '‚è≥ Gerando documento Word com fotos...';
                document.body.appendChild(processingDiv);

                // Coletar dados dos equipamentos
                const equipamentos = await coletarDadosEquipamentos(formData);
                
                // Criar documento Word usando docx
                const { Document, Packer, Paragraph, TextRun, HeadingLevel, AlignmentType, ImageRun, Table, TableRow, TableCell, WidthType } = docx;
                
                // Preparar elementos do documento
                const docElements = [];
                
                // Cabe√ßalho
                docElements.push(
                    new Paragraph({
                        children: [
                            new TextRun({
                                text: "SISTEMA LIMPA RIO COMUNIDADE",
                                bold: true,
                                size: 32,
                                color: "3B82F6"
                            })
                        ],
                        alignment: AlignmentType.CENTER,
                        spacing: { after: 200 }
                    }),
                    new Paragraph({
                        children: [
                            new TextRun({
                                text: "Relat√≥rio de Frente de Trabalho",
                                bold: true,
                                size: 24
                            })
                        ],
                        alignment: AlignmentType.CENTER,
                        spacing: { after: 400 }
                    })
                );

                // Dados B√°sicos
                docElements.push(
                    new Paragraph({
                        children: [
                            new TextRun({
                                text: "DADOS B√ÅSICOS",
                                bold: true,
                                size: 20,
                                color: "3B82F6"
                            })
                        ],
                        heading: HeadingLevel.HEADING_2,
                        spacing: { before: 200, after: 200 }
                    })
                );

                const dadosBasicos = [
                    [`C√≥digo da Frente:`, frente.codigo],
                    [`Corpo H√≠drico:`, frente.corpoHidrico],
                    [`Munic√≠pio:`, frente.municipio],
                    [`Bairro:`, frente.bairro],
                    [`Data da Visita:`, new Date(frente.dataVisita).toLocaleDateString('pt-BR')],
                    [`Regi√£o Hidrogr√°fica:`, formData.get('regiaoHidrografica') || 'N√£o informado']
                ];

                dadosBasicos.forEach(([label, value]) => {
                    docElements.push(
                        new Paragraph({
                            children: [
                                new TextRun({ text: label, bold: true }),
                                new TextRun({ text: ` ${value}` })
                            ],
                            spacing: { after: 100 }
                        })
                    );
                });

                // Equipe
                docElements.push(
                    new Paragraph({
                        children: [
                            new TextRun({
                                text: "EQUIPE",
                                bold: true,
                                size: 20,
                                color: "3B82F6"
                            })
                        ],
                        heading: HeadingLevel.HEADING_2,
                        spacing: { before: 300, after: 200 }
                    })
                );

                const dadosEquipe = [
                    [`T√©cnica Social:`, frente.tecnicaSocial],
                    [`Encarregados:`, formData.get('encarregados') || 'N√£o informado'],
                    [`Agentes Socioambientais:`, formData.get('agentesSocioambientais') || 'N√£o informado']
                ];

                dadosEquipe.forEach(([label, value]) => {
                    docElements.push(
                        new Paragraph({
                            children: [
                                new TextRun({ text: label, bold: true }),
                                new TextRun({ text: ` ${value}` })
                            ],
                            spacing: { after: 100 }
                        })
                    );
                });

                // Caracteriza√ß√£o da √Årea
                docElements.push(
                    new Paragraph({
                        children: [
                            new TextRun({
                                text: "CARACTERIZA√á√ÉO DA √ÅREA",
                                bold: true,
                                size: 20,
                                color: "3B82F6"
                            })
                        ],
                        heading: HeadingLevel.HEADING_2,
                        spacing: { before: 300, after: 200 }
                    })
                );

                const dadosArea = [
                    [`Comunidade no entorno:`, frente.comunidadeEntorno === 'sim' ? 'Sim' : 'N√£o'],
                    ...(frente.nomeComunidade ? [[`Nome da Comunidade:`, frente.nomeComunidade]] : []),
                    [`Constru√ß√µes √†s margens:`, formData.get('construcoesMargens') === 'sim' ? 'Sim' : 'N√£o'],
                    ...(formData.get('tipoConstrucao') ? [[`Tipo de Constru√ß√£o:`, formData.get('tipoConstrucao')]] : []),
                    ...(formData.get('quantidadeMoradias') ? [[`Quantidade de Moradias:`, formData.get('quantidadeMoradias')]] : [])
                ];

                dadosArea.forEach(([label, value]) => {
                    docElements.push(
                        new Paragraph({
                            children: [
                                new TextRun({ text: label, bold: true }),
                                new TextRun({ text: ` ${value}` })
                            ],
                            spacing: { after: 100 }
                        })
                    );
                });

                if (formData.get('observacoesGerais')) {
                    docElements.push(
                        new Paragraph({
                            children: [
                                new TextRun({ text: "Observa√ß√µes Gerais:", bold: true })
                            ],
                            spacing: { before: 200, after: 100 }
                        }),
                        new Paragraph({
                            children: [
                                new TextRun({ text: formData.get('observacoesGerais') })
                            ],
                            spacing: { after: 200 }
                        })
                    );
                }

                // Equipamentos P√∫blicos
                docElements.push(
                    new Paragraph({
                        children: [
                            new TextRun({
                                text: "EQUIPAMENTOS P√öBLICOS IDENTIFICADOS",
                                bold: true,
                                size: 20,
                                color: "3B82F6"
                            })
                        ],
                        heading: HeadingLevel.HEADING_2,
                        spacing: { before: 400, after: 200 }
                    })
                );

                // Adicionar cada tipo de equipamento
                for (const [tipo, dados] of Object.entries(equipamentos)) {
                    if (dados.length > 0) {
                        const tipoTitulos = {
                            escolas: "üéì ESCOLAS",
                            saude: "üè• UNIDADES DE SA√öDE", 
                            transporte: "üöå TRANSPORTE P√öBLICO",
                            lazer: "üèûÔ∏è √ÅREAS DE LAZER",
                            religiosas: "‚õ™ INSTITUI√á√ïES RELIGIOSAS",
                            associacoes: "üèòÔ∏è ASSOCIA√á√ïES DE MORADORES",
                            comercios: "üè™ COM√âRCIOS LOCAIS"
                        };

                        docElements.push(
                            new Paragraph({
                                children: [
                                    new TextRun({
                                        text: tipoTitulos[tipo],
                                        bold: true,
                                        size: 16,
                                        color: "059669"
                                    })
                                ],
                                spacing: { before: 300, after: 150 }
                            })
                        );

                        dados.forEach((item, index) => {
                            docElements.push(
                                new Paragraph({
                                    children: [
                                        new TextRun({
                                            text: `${index + 1}. ${item.nome || item.linha || 'N√£o informado'}`,
                                            bold: true
                                        })
                                    ],
                                    spacing: { before: 150, after: 50 }
                                })
                            );

                            // Adicionar detalhes espec√≠ficos do equipamento
                            const detalhes = [];
                            if (item.endereco) detalhes.push(`Endere√ßo: ${item.endereco}`);
                            if (item.segmento) detalhes.push(`Segmento: ${item.segmento}`);
                            if (item.empresa) detalhes.push(`Empresa: ${item.empresa}`);
                            if (item.tipo) detalhes.push(`Tipo: ${item.tipo}`);
                            if (item.descricao) detalhes.push(`Descri√ß√£o: ${item.descricao}`);
                            if (item.contato) detalhes.push(`Contato: ${item.contato}`);

                            if (detalhes.length > 0) {
                                docElements.push(
                                    new Paragraph({
                                        children: [
                                            new TextRun({ text: detalhes.join(' | ') })
                                        ],
                                        spacing: { after: 100 }
                                    })
                                );
                            }

                            // Adicionar fotos do equipamento se houver
                            if (item.fotos && item.fotos.length > 0) {
                                docElements.push(
                                    new Paragraph({
                                        children: [
                                            new TextRun({ text: "Fotos:", bold: true, italics: true })
                                        ],
                                        spacing: { before: 100, after: 50 }
                                    })
                                );

                                for (const foto of item.fotos.slice(0, 3)) { // M√°ximo 3 fotos por equipamento
                                    try {
                                        const imageBuffer = await dataURLtoBuffer(foto.data);
                                        docElements.push(
                                            new Paragraph({
                                                children: [
                                                    new ImageRun({
                                                        data: imageBuffer,
                                                        transformation: {
                                                            width: 200,
                                                            height: 150
                                                        }
                                                    })
                                                ],
                                                spacing: { after: 100 }
                                            })
                                        );
                                    } catch (error) {
                                        console.warn('Erro ao processar foto:', error);
                                    }
                                }
                            }
                        });
                    }
                }

                // Fotos gerais
                if (uploadedPhotos.length > 0) {
                    docElements.push(
                        new Paragraph({
                            children: [
                                new TextRun({
                                    text: "üì∏ FOTOS GERAIS DA FRENTE",
                                    bold: true,
                                    size: 20,
                                    color: "3B82F6"
                                })
                            ],
                            heading: HeadingLevel.HEADING_2,
                            spacing: { before: 400, after: 200 }
                        })
                    );

                    for (const foto of uploadedPhotos.slice(0, 6)) { // M√°ximo 6 fotos gerais
                        try {
                            const imageBuffer = await dataURLtoBuffer(foto.data);
                            docElements.push(
                                new Paragraph({
                                    children: [
                                        new ImageRun({
                                            data: imageBuffer,
                                            transformation: {
                                                width: 300,
                                                height: 200
                                            }
                                        })
                                    ],
                                    alignment: AlignmentType.CENTER,
                                    spacing: { after: 200 }
                                }),
                                new Paragraph({
                                    children: [
                                        new TextRun({
                                            text: foto.name,
                                            italics: true,
                                            size: 18
                                        })
                                    ],
                                    alignment: AlignmentType.CENTER,
                                    spacing: { after: 300 }
                                })
                            );
                        } catch (error) {
                            console.warn('Erro ao processar foto geral:', error);
                        }
                    }
                }

                // Rodap√©
                docElements.push(
                    new Paragraph({
                        children: [
                            new TextRun({
                                text: `Relat√≥rio gerado em ${new Date().toLocaleDateString('pt-BR')} √†s ${new Date().toLocaleTimeString('pt-BR')}`,
                                size: 16,
                                color: "6B7280"
                            })
                        ],
                        alignment: AlignmentType.CENTER,
                        spacing: { before: 600, after: 100 }
                    }),
                    new Paragraph({
                        children: [
                            new TextRun({
                                text: "Sistema Limpa Rio Comunidade - Reconhecimento S√≥cio Territorial",
                                size: 16,
                                color: "6B7280",
                                italics: true
                            })
                        ],
                        alignment: AlignmentType.CENTER
                    })
                );

                // Criar documento
                const doc = new Document({
                    sections: [{
                        properties: {},
                        children: docElements
                    }]
                });

                // Gerar e baixar
                const buffer = await Packer.toBuffer(doc);
                const blob = new Blob([buffer], { 
                    type: 'application/vnd.openxmlformats-officedocument.wordprocessingml.document' 
                });
                
                const url = window.URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.style.display = 'none';
                a.href = url;
                a.download = `Frente_${frente.codigo}_${frente.corpoHidrico.replace(/\s+/g, '_')}.docx`;
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                window.URL.revokeObjectURL(url);

                // Atualizar mensagem de sucesso
                processingDiv.className = 'fixed top-4 right-4 bg-green-600 text-white px-6 py-3 rounded-lg shadow-lg z-50';
                processingDiv.innerHTML = '‚úÖ Documento Word gerado com sucesso!';
                
                setTimeout(() => {
                    processingDiv.remove();
                }, 4000);
                
            } catch (error) {
                console.error('Erro ao gerar documento Word:', error);
                alert('Erro ao gerar documento Word. Verifique os dados e tente novamente.');
            }
        }

        // Fun√ß√£o auxiliar para coletar dados dos equipamentos
        async function coletarDadosEquipamentos(formData) {
            const equipamentos = {
                escolas: [],
                saude: [],
                transporte: [],
                lazer: [],
                religiosas: [],
                associacoes: [],
                comercios: []
            };

            // Escolas
            const escolaNomes = formData.getAll('escola_nome[]');
            const escolaEnderecos = formData.getAll('escola_endereco[]');
            const escolaSegmentos = formData.getAll('escola_segmento[]');
            
            for (let i = 0; i < escolaNomes.length; i++) {
                if (escolaNomes[i] && escolaNomes[i].trim()) {
                    const escola = {
                        nome: escolaNomes[i],
                        endereco: escolaEnderecos[i] || '',
                        segmento: escolaSegmentos[i] || '',
                        fotos: []
                    };
                    
                    // Buscar fotos da escola
                    const escolaItems = document.querySelectorAll('.escola-item');
                    if (escolaItems[i] && escolaItems[i].equipamentoPhotos) {
                        escola.fotos = escolaItems[i].equipamentoPhotos;
                    }
                    
                    equipamentos.escolas.push(escola);
                }
            }

            // Unidades de Sa√∫de
            const saudeNomes = formData.getAll('saude_nome[]');
            const saudeEnderecos = formData.getAll('saude_endereco[]');
            
            for (let i = 0; i < saudeNomes.length; i++) {
                if (saudeNomes[i] && saudeNomes[i].trim()) {
                    const saude = {
                        nome: saudeNomes[i],
                        endereco: saudeEnderecos[i] || '',
                        fotos: []
                    };
                    
                    const saudeItems = document.querySelectorAll('.saude-item');
                    if (saudeItems[i] && saudeItems[i].equipamentoPhotos) {
                        saude.fotos = saudeItems[i].equipamentoPhotos;
                    }
                    
                    equipamentos.saude.push(saude);
                }
            }

            // Transporte
            const transporteLinhas = formData.getAll('transporte_linha[]');
            const transporteEmpresas = formData.getAll('transporte_empresa[]');
            const transporteTipos = formData.getAll('transporte_tipo[]');
            
            for (let i = 0; i < transporteLinhas.length; i++) {
                if (transporteLinhas[i] && transporteLinhas[i].trim()) {
                    const transporte = {
                        linha: transporteLinhas[i],
                        empresa: transporteEmpresas[i] || '',
                        tipo: transporteTipos[i] || '',
                        fotos: []
                    };
                    
                    const transporteItems = document.querySelectorAll('.transporte-item');
                    if (transporteItems[i] && transporteItems[i].equipamentoPhotos) {
                        transporte.fotos = transporteItems[i].equipamentoPhotos;
                    }
                    
                    equipamentos.transporte.push(transporte);
                }
            }

            // √Åreas de Lazer
            const lazerNomes = formData.getAll('lazer_nome[]');
            const lazerEnderecos = formData.getAll('lazer_endereco[]');
            const lazerDescricoes = formData.getAll('lazer_descricao[]');
            
            for (let i = 0; i < lazerNomes.length; i++) {
                if (lazerNomes[i] && lazerNomes[i].trim()) {
                    const lazer = {
                        nome: lazerNomes[i],
                        endereco: lazerEnderecos[i] || '',
                        descricao: lazerDescricoes[i] || '',
                        fotos: []
                    };
                    
                    const lazerItems = document.querySelectorAll('.lazer-item');
                    if (lazerItems[i] && lazerItems[i].equipamentoPhotos) {
                        lazer.fotos = lazerItems[i].equipamentoPhotos;
                    }
                    
                    equipamentos.lazer.push(lazer);
                }
            }

            // Institui√ß√µes Religiosas
            const religiosasNomes = formData.getAll('religiosas_nome[]');
            const religiosasEnderecos = formData.getAll('religiosas_endereco[]');
            const religiosasTipos = formData.getAll('religiosas_tipo[]');
            
            for (let i = 0; i < religiosasNomes.length; i++) {
                if (religiosasNomes[i] && religiosasNomes[i].trim()) {
                    const religiosa = {
                        nome: religiosasNomes[i],
                        endereco: religiosasEnderecos[i] || '',
                        tipo: religiosasTipos[i] || '',
                        fotos: []
                    };
                    
                    const religiosasItems = document.querySelectorAll('.religiosas-item');
                    if (religiosasItems[i] && religiosasItems[i].equipamentoPhotos) {
                        religiosa.fotos = religiosasItems[i].equipamentoPhotos;
                    }
                    
                    equipamentos.religiosas.push(religiosa);
                }
            }

            // Associa√ß√µes
            const associacoesNomes = formData.getAll('associacoes_nome[]');
            const associacoesEnderecos = formData.getAll('associacoes_endereco[]');
            const associacoesContatos = formData.getAll('associacoes_contato[]');
            
            for (let i = 0; i < associacoesNomes.length; i++) {
                if (associacoesNomes[i] && associacoesNomes[i].trim()) {
                    const associacao = {
                        nome: associacoesNomes[i],
                        endereco: associacoesEnderecos[i] || '',
                        contato: associacoesContatos[i] || '',
                        fotos: []
                    };
                    
                    const associacoesItems = document.querySelectorAll('.associacoes-item');
                    if (associacoesItems[i] && associacoesItems[i].equipamentoPhotos) {
                        associacao.fotos = associacoesItems[i].equipamentoPhotos;
                    }
                    
                    equipamentos.associacoes.push(associacao);
                }
            }

            // Com√©rcios
            const comerciosNomes = formData.getAll('comercios_nome[]');
            const comerciosEnderecos = formData.getAll('comercios_endereco[]');
            const comerciosTipos = formData.getAll('comercios_tipo[]');
            
            for (let i = 0; i < comerciosNomes.length; i++) {
                if (comerciosNomes[i] && comerciosNomes[i].trim()) {
                    const comercio = {
                        nome: comerciosNomes[i],
                        endereco: comerciosEnderecos[i] || '',
                        tipo: comerciosTipos[i] || '',
                        fotos: []
                    };
                    
                    const comerciosItems = document.querySelectorAll('.comercios-item');
                    if (comerciosItems[i] && comerciosItems[i].equipamentoPhotos) {
                        comercio.fotos = comerciosItems[i].equipamentoPhotos;
                    }
                    
                    equipamentos.comercios.push(comercio);
                }
            }

            return equipamentos;
        }

        // Fun√ß√£o auxiliar para converter dataURL em buffer
        function dataURLtoBuffer(dataURL) {
            return new Promise((resolve, reject) => {
                try {
                    const base64 = dataURL.split(',')[1];
                    const binaryString = window.atob(base64);
                    const bytes = new Uint8Array(binaryString.length);
                    for (let i = 0; i < binaryString.length; i++) {
                        bytes[i] = binaryString.charCodeAt(i);
                    }
                    resolve(bytes);
                } catch (error) {
                    reject(error);
                }
            });
        }

        // Manipula√ß√£o de dados
        document.getElementById('frenteForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const formData = new FormData(this);
            const editingId = this.dataset.editingId;
            
            if (editingId) {
                // Modo edi√ß√£o - atualizar frente existente
                const frenteIndex = frentes.findIndex(f => f.id == editingId);
                if (frenteIndex !== -1) {
                    frentes[frenteIndex] = {
                        ...frentes[frenteIndex], // Manter dados existentes
                        codigo: formData.get('codigo'),
                        corpoHidrico: formData.get('corpoHidrico'),
                        municipio: formData.get('municipio'),
                        bairro: formData.get('bairro'),
                        dataVisita: formData.get('dataVisita'),
                        tecnicaSocial: formData.get('tecnicaSocial'),
                        comunidadeEntorno: formData.get('comunidadeEntorno'),
                        nomeComunidade: formData.get('nomeComunidade'),
                        fotos: [...uploadedPhotos] // Atualizar fotos se houver
                    };
                    
                    // Mostrar mensagem de sucesso
                    const successDiv = document.createElement('div');
                    successDiv.className = 'fixed top-4 right-4 bg-green-600 text-white px-6 py-3 rounded-lg shadow-lg z-50';
                    successDiv.innerHTML = `‚úÖ Frente ${frentes[frenteIndex].codigo} atualizada com sucesso!`;
                    document.body.appendChild(successDiv);
                    
                    setTimeout(() => {
                        successDiv.remove();
                    }, 4000);
                    
                    // Cancelar modo de edi√ß√£o
                    cancelarEdicao();
                    
                    // Atualizar tabelas
                    atualizarTabelaFrente();
                    atualizarDashboard();
                    
                    // Voltar para lista de frentes
                    showSection('listar-frentes');
                }
            } else {
                // Modo cria√ß√£o - criar nova frente
                const novaFrente = {
                    id: frentes.length + 1,
                    codigo: formData.get('codigo'),
                    corpoHidrico: formData.get('corpoHidrico'),
                    municipio: formData.get('municipio'),
                    bairro: formData.get('bairro'),
                    dataVisita: formData.get('dataVisita'),
                    status: 'Conclu√≠do',
                    tecnicaSocial: formData.get('tecnicaSocial'),
                    comunidadeEntorno: formData.get('comunidadeEntorno'),
                    nomeComunidade: formData.get('nomeComunidade'),
                    fotos: [...uploadedPhotos]
                };
                
                frentes.push(novaFrente);
                
                // Mostrar mensagem de processamento
                const processingDiv = document.createElement('div');
                processingDiv.className = 'fixed top-4 right-4 bg-blue-600 text-white px-6 py-3 rounded-lg shadow-lg z-50';
                processingDiv.innerHTML = '‚è≥ Salvando frente e gerando documentos...';
                document.body.appendChild(processingDiv);
                
                // Gerar documentos ap√≥s um pequeno delay para mostrar a mensagem
                setTimeout(() => {
                    // Gerar PDF
                    gerarPDFFrente(novaFrente, formData);
                    
                    // Gerar Word (com delay para n√£o conflitar)
                    setTimeout(() => {
                        gerarWordFrente(novaFrente, formData);
                    }, 1000);
                    
                    // Atualizar mensagem de sucesso
                    processingDiv.className = 'fixed top-4 right-4 bg-green-600 text-white px-6 py-3 rounded-lg shadow-lg z-50';
                    processingDiv.innerHTML = '‚úÖ Frente salva! PDF e Word gerados automaticamente!';
                    
                    setTimeout(() => {
                        processingDiv.remove();
                    }, 4000);
                }, 500);
                
                // Limpar formul√°rio
                limparFormulario();
                
                // Atualizar dashboard
                atualizarDashboard();
            }
        });

        document.getElementById('usuarioForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const formData = new FormData(this);
            const novoUsuario = {
                id: usuarios.length + 1,
                nome: formData.get('nomeUsuario'),
                email: formData.get('emailUsuario'),
                perfil: formData.get('perfilUsuario'),
                status: 'Ativo'
            };
            
            usuarios.push(novoUsuario);
            this.reset();
            atualizarTabelaUsuarios();
            
            // Mostrar mensagem de sucesso
            const successDiv = document.createElement('div');
            successDiv.className = 'fixed top-4 right-4 bg-green-600 text-white px-6 py-3 rounded-lg shadow-lg z-50';
            successDiv.innerHTML = '‚úÖ Usu√°rio adicionado com sucesso!';
            document.body.appendChild(successDiv);
            
            setTimeout(() => {
                successDiv.remove();
            }, 3000);
        });

        function atualizarTabelaFrente() {
            const tbody = document.getElementById('frentesTableBody');
            tbody.innerHTML = '';
            
            frentes.forEach(frente => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">${frente.codigo}</td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">${frente.corpoHidrico}</td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">${frente.municipio}</td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">${new Date(frente.dataVisita).toLocaleDateString('pt-BR')}</td>
                    <td class="px-6 py-4 whitespace-nowrap">
                        <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${frente.status === 'Conclu√≠do' ? 'bg-green-100 text-green-800' : 'bg-yellow-100 text-yellow-800'}">
                            ${frente.status}
                        </span>
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm font-medium">
                        <button onclick="visualizarFrente(${frente.id})" class="text-blue-600 hover:text-blue-900 mr-3">Ver</button>
                        <button onclick="editarFrente(${frente.id})" class="text-indigo-600 hover:text-indigo-900 mr-3">Editar</button>
                        <button onclick="excluirFrente(${frente.id})" class="text-red-600 hover:text-red-900">Excluir</button>
                    </td>
                `;
                tbody.appendChild(row);
            });
        }

        function atualizarTabelaUsuarios() {
            const tbody = document.getElementById('usuariosTableBody');
            tbody.innerHTML = '';
            
            usuarios.forEach(usuario => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">${usuario.nome}</td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">${usuario.email}</td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">${usuario.perfil}</td>
                    <td class="px-6 py-4 whitespace-nowrap">
                        <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-green-100 text-green-800">
                            ${usuario.status}
                        </span>
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm font-medium">
                        <button onclick="editarUsuario(${usuario.id})" class="text-indigo-600 hover:text-indigo-900 mr-3">Editar</button>
                        <button onclick="excluirUsuario(${usuario.id})" class="text-red-600 hover:text-red-900">Excluir</button>
                    </td>
                `;
                tbody.appendChild(row);
            });
        }

        function atualizarDashboard() {
            document.getElementById('totalFrentes').textContent = frentes.length;
            document.getElementById('totalComunidades').textContent = frentes.filter(f => f.comunidadeEntorno === 'sim').length;
        }

        // A√ß√µes
        function visualizarFrente(id) {
            const frente = frentes.find(f => f.id === id);
            if (frente) {
                const modal = document.createElement('div');
                modal.className = 'fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4';
                modal.innerHTML = `
                    <div class="bg-white rounded-lg p-6 max-w-2xl w-full max-h-full overflow-y-auto">
                        <h3 class="text-xl font-bold mb-4">Detalhes da Frente ${frente.codigo}</h3>
                        <div class="space-y-3">
                            <p><strong>Corpo H√≠drico:</strong> ${frente.corpoHidrico}</p>
                            <p><strong>Munic√≠pio:</strong> ${frente.municipio}</p>
                            <p><strong>Bairro:</strong> ${frente.bairro}</p>
                            <p><strong>Data da Visita:</strong> ${new Date(frente.dataVisita).toLocaleDateString('pt-BR')}</p>
                            <p><strong>T√©cnica Social:</strong> ${frente.tecnicaSocial}</p>
                            <p><strong>Comunidade no Entorno:</strong> ${frente.comunidadeEntorno === 'sim' ? 'Sim' : 'N√£o'}</p>
                            ${frente.nomeComunidade ? `<p><strong>Nome da Comunidade:</strong> ${frente.nomeComunidade}</p>` : ''}
                        </div>
                        <button onclick="this.parentElement.parentElement.remove()" class="mt-6 bg-blue-600 text-white px-4 py-2 rounded-lg">Fechar</button>
                    </div>
                `;
                document.body.appendChild(modal);
            }
        }

        function editarFrente(id) {
            const frente = frentes.find(f => f.id === id);
            if (!frente) return;
            
            // Preencher formul√°rio com dados da frente
            const form = document.getElementById('frenteForm');
            form.querySelector('[name="codigo"]').value = frente.codigo;
            form.querySelector('[name="corpoHidrico"]').value = frente.corpoHidrico;
            form.querySelector('[name="municipio"]').value = frente.municipio;
            form.querySelector('[name="bairro"]').value = frente.bairro;
            form.querySelector('[name="dataVisita"]').value = frente.dataVisita;
            form.querySelector('[name="tecnicaSocial"]').value = frente.tecnicaSocial;
            form.querySelector('[name="comunidadeEntorno"]').value = frente.comunidadeEntorno || '';
            form.querySelector('[name="nomeComunidade"]').value = frente.nomeComunidade || '';
            
            // Mostrar campos condicionais se necess√°rio
            if (frente.comunidadeEntorno === 'sim') {
                document.getElementById('nomeComunidadeDiv').classList.remove('hidden');
            }
            
            // Adicionar ID da frente sendo editada ao formul√°rio
            form.dataset.editingId = id;
            
            // Alterar texto do bot√£o de submit
            const submitBtn = form.querySelector('button[type="submit"]');
            submitBtn.innerHTML = '‚úèÔ∏è Atualizar Frente de Trabalho';
            submitBtn.className = 'bg-orange-600 hover:bg-orange-700 text-white px-8 py-3 rounded-lg font-medium transition-all flex-1';
            
            // Adicionar bot√£o de cancelar edi√ß√£o
            const cancelBtn = document.createElement('button');
            cancelBtn.type = 'button';
            cancelBtn.className = 'bg-gray-600 hover:bg-gray-700 text-white px-8 py-3 rounded-lg font-medium transition-all';
            cancelBtn.innerHTML = '‚ùå Cancelar Edi√ß√£o';
            cancelBtn.onclick = cancelarEdicao;
            
            const buttonContainer = submitBtn.parentElement;
            if (!buttonContainer.querySelector('.cancel-edit-btn')) {
                cancelBtn.classList.add('cancel-edit-btn');
                buttonContainer.insertBefore(cancelBtn, submitBtn.nextSibling);
            }
            
            // Ir para a se√ß√£o de nova frente
            showSection('nova-frente');
            
            // Scroll para o topo
            window.scrollTo({ top: 0, behavior: 'smooth' });
            
            // Mostrar mensagem de edi√ß√£o
            const editMsg = document.createElement('div');
            editMsg.className = 'fixed top-4 right-4 bg-orange-600 text-white px-6 py-3 rounded-lg shadow-lg z-50';
            editMsg.innerHTML = `‚úèÔ∏è Editando Frente ${frente.codigo} - ${frente.corpoHidrico}`;
            document.body.appendChild(editMsg);
            
            setTimeout(() => {
                editMsg.remove();
            }, 4000);
        }
        
        function cancelarEdicao() {
            const form = document.getElementById('frenteForm');
            
            // Limpar formul√°rio
            form.reset();
            document.getElementById('photoPreview').innerHTML = '';
            uploadedPhotos = [];
            
            // Esconder campos condicionais
            document.getElementById('nomeComunidadeDiv').classList.add('hidden');
            document.getElementById('tipoConstrucaoDiv').classList.add('hidden');
            document.getElementById('quantidadeMoradiasDiv').classList.add('hidden');
            
            // Remover ID de edi√ß√£o
            delete form.dataset.editingId;
            
            // Restaurar bot√£o original
            const submitBtn = form.querySelector('button[type="submit"]');
            submitBtn.innerHTML = 'üíæ Salvar Frente de Trabalho';
            submitBtn.className = 'btn-primary text-white px-8 py-3 rounded-lg font-medium flex-1';
            
            // Remover bot√£o de cancelar
            const cancelBtn = form.querySelector('.cancel-edit-btn');
            if (cancelBtn) {
                cancelBtn.remove();
            }
            
            // Mostrar mensagem
            const cancelMsg = document.createElement('div');
            cancelMsg.className = 'fixed top-4 right-4 bg-gray-600 text-white px-6 py-3 rounded-lg shadow-lg z-50';
            cancelMsg.innerHTML = '‚ùå Edi√ß√£o cancelada';
            document.body.appendChild(cancelMsg);
            
            setTimeout(() => {
                cancelMsg.remove();
            }, 3000);
        }

        function excluirFrente(id) {
            if (confirm('Tem certeza que deseja excluir esta frente?')) {
                frentes = frentes.filter(f => f.id !== id);
                atualizarTabelaFrente();
                atualizarDashboard();
            }
        }

        function editarUsuario(id) {
            alert('Funcionalidade de edi√ß√£o ser√° implementada');
        }

        function excluirUsuario(id) {
            if (confirm('Tem certeza que deseja excluir este usu√°rio?')) {
                usuarios = usuarios.filter(u => u.id !== id);
                atualizarTabelaUsuarios();
            }
        }

        function aplicarFiltros() {
            // Implementar filtros
            alert('Filtros aplicados com sucesso!');
        }

        function exportarDados() {
            // Criar cabe√ßalho CSV
            const cabecalho = 'C√≥digo,Corpo H√≠drico,Munic√≠pio,Bairro,Data da Visita,Status,T√©cnica Social,Comunidade no Entorno,Nome da Comunidade\n';
            
            // Criar conte√∫do CSV
            const csvContent = cabecalho + frentes.map(f => 
                `"${f.codigo}","${f.corpoHidrico}","${f.municipio}","${f.bairro}","${f.dataVisita}","${f.status}","${f.tecnicaSocial || ''}","${f.comunidadeEntorno || ''}","${f.nomeComunidade || ''}"`
            ).join('\n');
            
            // Criar e baixar arquivo
            const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8' });
            const url = window.URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.style.display = 'none';
            a.href = url;
            a.download = `frentes_limpa_rio_${new Date().toISOString().split('T')[0]}.csv`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            window.URL.revokeObjectURL(url);
            
            // Mostrar mensagem de sucesso
            const successDiv = document.createElement('div');
            successDiv.className = 'fixed top-4 right-4 bg-green-600 text-white px-6 py-3 rounded-lg shadow-lg z-50';
            successDiv.innerHTML = '‚úÖ Dados exportados para CSV com sucesso!';
            document.body.appendChild(successDiv);
            
            setTimeout(() => {
                successDiv.remove();
            }, 3000);
        }

        function gerarRelatorio() {
            alert('Relat√≥rio PDF gerado com sucesso! (Funcionalidade simulada)');
        }

        function gerarRelatorioPDF() {
            alert('Relat√≥rio PDF completo gerado! (Funcionalidade simulada)');
        }

        function exportarExcel() {
            alert('Dados exportados para Excel! (Funcionalidade simulada)');
        }

        function gerarRelatorioSintese() {
            alert('Relat√≥rio de s√≠ntese gerado! (Funcionalidade simulada)');
        }

        function importarCSV() {
            // Criar input file invis√≠vel
            const input = document.createElement('input');
            input.type = 'file';
            input.accept = '.csv';
            input.style.display = 'none';
            
            input.onchange = function(event) {
                const file = event.target.files[0];
                if (!file) return;
                
                const reader = new FileReader();
                reader.onload = function(e) {
                    try {
                        const csv = e.target.result;
                        const linhas = csv.split('\n');
                        
                        // Verificar se tem cabe√ßalho
                        if (linhas.length < 2) {
                            alert('‚ùå Arquivo CSV deve ter pelo menos uma linha de dados al√©m do cabe√ßalho.');
                            return;
                        }
                        
                        // Processar cabe√ßalho (primeira linha)
                        const cabecalho = linhas[0].split(',').map(col => col.trim().replace(/"/g, ''));
                        
                        // Verificar colunas obrigat√≥rias
                        const colunasObrigatorias = ['codigo', 'corpoHidrico', 'municipio', 'bairro', 'dataVisita', 'tecnicaSocial'];
                        const colunasFaltando = colunasObrigatorias.filter(col => 
                            !cabecalho.some(h => h.toLowerCase().includes(col.toLowerCase()))
                        );
                        
                        if (colunasFaltando.length > 0) {
                            alert(`‚ùå Colunas obrigat√≥rias n√£o encontradas: ${colunasFaltando.join(', ')}\n\nFormato esperado: codigo,corpoHidrico,municipio,bairro,dataVisita,tecnicaSocial,comunidadeEntorno,nomeComunidade`);
                            return;
                        }
                        
                        let frentesImportadas = 0;
                        let erros = [];
                        
                        // Processar dados (pular primeira linha do cabe√ßalho)
                        for (let i = 1; i < linhas.length; i++) {
                            const linha = linhas[i].trim();
                            if (!linha) continue; // Pular linhas vazias
                            
                            const dados = linha.split(',').map(col => col.trim().replace(/"/g, ''));
                            
                            try {
                                // Mapear dados baseado no cabe√ßalho
                                const novaFrente = {
                                    id: frentes.length + frentesImportadas + 1,
                                    codigo: dados[cabecalho.findIndex(h => h.toLowerCase().includes('codigo'))] || '',
                                    corpoHidrico: dados[cabecalho.findIndex(h => h.toLowerCase().includes('corpohidrico') || h.toLowerCase().includes('corpo'))] || '',
                                    municipio: dados[cabecalho.findIndex(h => h.toLowerCase().includes('municipio'))] || '',
                                    bairro: dados[cabecalho.findIndex(h => h.toLowerCase().includes('bairro'))] || '',
                                    dataVisita: dados[cabecalho.findIndex(h => h.toLowerCase().includes('datavisita') || h.toLowerCase().includes('data'))] || '',
                                    tecnicaSocial: dados[cabecalho.findIndex(h => h.toLowerCase().includes('tecnicasocial') || h.toLowerCase().includes('tecnica'))] || '',
                                    comunidadeEntorno: dados[cabecalho.findIndex(h => h.toLowerCase().includes('comunidadeentorno') || h.toLowerCase().includes('comunidade'))] || 'nao',
                                    nomeComunidade: dados[cabecalho.findIndex(h => h.toLowerCase().includes('nomecomunidade') || h.toLowerCase().includes('nome'))] || '',
                                    status: 'Importado',
                                    fotos: []
                                };
                                
                                // Validar dados obrigat√≥rios
                                if (!novaFrente.codigo || !novaFrente.corpoHidrico || !novaFrente.municipio || !novaFrente.bairro || !novaFrente.dataVisita || !novaFrente.tecnicaSocial) {
                                    erros.push(`Linha ${i + 1}: Dados obrigat√≥rios faltando`);
                                    continue;
                                }
                                
                                // Verificar se c√≥digo j√° existe
                                if (frentes.some(f => f.codigo === novaFrente.codigo)) {
                                    erros.push(`Linha ${i + 1}: C√≥digo ${novaFrente.codigo} j√° existe`);
                                    continue;
                                }
                                
                                // Validar formato da data
                                const dataRegex = /^\d{4}-\d{2}-\d{2}$/;
                                if (!dataRegex.test(novaFrente.dataVisita)) {
                                    // Tentar converter formato brasileiro para ISO
                                    const dataBR = novaFrente.dataVisita.match(/^(\d{2})\/(\d{2})\/(\d{4})$/);
                                    if (dataBR) {
                                        novaFrente.dataVisita = `${dataBR[3]}-${dataBR[2]}-${dataBR[1]}`;
                                    } else {
                                        erros.push(`Linha ${i + 1}: Data inv√°lida (use formato AAAA-MM-DD ou DD/MM/AAAA)`);
                                        continue;
                                    }
                                }
                                
                                frentes.push(novaFrente);
                                frentesImportadas++;
                                
                            } catch (error) {
                                erros.push(`Linha ${i + 1}: Erro ao processar dados - ${error.message}`);
                            }
                        }
                        
                        // Mostrar resultado da importa√ß√£o
                        let mensagem = `‚úÖ Importa√ß√£o conclu√≠da!\n\n`;
                        mensagem += `üìä Frentes importadas: ${frentesImportadas}\n`;
                        
                        if (erros.length > 0) {
                            mensagem += `‚ö†Ô∏è Erros encontrados: ${erros.length}\n\n`;
                            mensagem += `Detalhes dos erros:\n${erros.slice(0, 10).join('\n')}`;
                            if (erros.length > 10) {
                                mensagem += `\n... e mais ${erros.length - 10} erros.`;
                            }
                        }
                        
                        alert(mensagem);
                        
                        // Atualizar interface se houve importa√ß√µes
                        if (frentesImportadas > 0) {
                            atualizarDashboard();
                            if (document.getElementById('listar-frentes').classList.contains('section') && !document.getElementById('listar-frentes').classList.contains('hidden')) {
                                atualizarTabelaFrente();
                            }
                        }
                        
                    } catch (error) {
                        alert(`‚ùå Erro ao processar arquivo CSV: ${error.message}\n\nVerifique se o arquivo est√° no formato correto.`);
                    }
                };
                
                reader.readAsText(file, 'UTF-8');
            };
            
            // Mostrar modal com instru√ß√µes antes de abrir o seletor
            const modal = document.createElement('div');
            modal.className = 'fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4';
            modal.innerHTML = `
                <div class="bg-white rounded-lg p-6 max-w-2xl w-full max-h-full overflow-y-auto">
                    <h3 class="text-xl font-bold mb-4 text-blue-600">üì• Importar Dados CSV</h3>
                    
                    <div class="mb-6">
                        <h4 class="font-semibold mb-2">üìã Formato do Arquivo CSV:</h4>
                        <div class="bg-gray-100 p-3 rounded-lg text-sm font-mono">
                            codigo,corpoHidrico,municipio,bairro,dataVisita,tecnicaSocial,comunidadeEntorno,nomeComunidade<br>
                            168,Rio Maracan√£,Rio de Janeiro,Tijuca,2024-01-20,Ana Silva,sim,Vila Maracan√£<br>
                            169,Rio Joana,Rio de Janeiro,Tijuca,2024-01-21,Jo√£o Santos,nao,
                        </div>
                    </div>
                    
                    <div class="mb-6">
                        <h4 class="font-semibold mb-2">‚ö†Ô∏è Observa√ß√µes Importantes:</h4>
                        <ul class="text-sm text-gray-600 space-y-1">
                            <li>‚Ä¢ <strong>Colunas obrigat√≥rias:</strong> codigo, corpoHidrico, municipio, bairro, dataVisita, tecnicaSocial</li>
                            <li>‚Ä¢ <strong>Data:</strong> Use formato AAAA-MM-DD ou DD/MM/AAAA</li>
                            <li>‚Ä¢ <strong>Comunidade:</strong> Use "sim" ou "nao" para comunidadeEntorno</li>
                            <li>‚Ä¢ <strong>C√≥digos √∫nicos:</strong> Cada c√≥digo de frente deve ser √∫nico</li>
                            <li>‚Ä¢ <strong>Encoding:</strong> Salve o arquivo em UTF-8 para caracteres especiais</li>
                        </ul>
                    </div>
                    
                    <div class="flex gap-4">
                        <button onclick="this.parentElement.parentElement.parentElement.remove(); document.body.appendChild(input); input.click();" class="flex-1 bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg font-medium transition-all">
                            üìÇ Selecionar Arquivo CSV
                        </button>
                        <button onclick="baixarModeloCSV()" class="flex-1 bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-lg font-medium transition-all">
                            üìÑ Baixar Modelo
                        </button>
                        <button onclick="this.parentElement.parentElement.parentElement.remove()" class="bg-gray-600 hover:bg-gray-700 text-white px-4 py-2 rounded-lg font-medium transition-all">
                            Cancelar
                        </button>
                    </div>
                </div>
            `;
            document.body.appendChild(modal);
        }
        
        function baixarModeloCSV() {
            const modelo = `codigo,corpoHidrico,municipio,bairro,dataVisita,tecnicaSocial,comunidadeEntorno,nomeComunidade
168,Rio Maracan√£,Rio de Janeiro,Tijuca,2024-01-20,Ana Silva,sim,Vila Maracan√£
169,Rio Joana,Rio de Janeiro,Tijuca,2024-01-21,Jo√£o Santos,nao,
170,Rio Comprido,Rio de Janeiro,Rio Comprido,2024-01-22,Maria Costa,sim,Comunidade do Rio Comprido`;
            
            const blob = new Blob([modelo], { type: 'text/csv;charset=utf-8' });
            const url = window.URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'modelo_importacao_frentes.csv';
            a.click();
            window.URL.revokeObjectURL(url);
        }

        async function exportarFrenteAtual() {
            const form = document.getElementById('frenteForm');
            const formData = new FormData(form);
            
            // Verificar se h√° dados no formul√°rio
            if (!formData.get('codigo') && !formData.get('corpoHidrico')) {
                alert('‚ö†Ô∏è Preencha pelo menos o c√≥digo e corpo h√≠drico para exportar os dados.');
                return;
            }
            
            try {
                // Coletar dados completos dos equipamentos
                const equipamentos = await coletarDadosEquipamentos(formData);
                
                // Criar CSV com dados da frente atual
                let csvContent = 'DADOS B√ÅSICOS\n';
                csvContent += 'Campo,Valor\n';
                csvContent += `C√≥digo da Frente,"${formData.get('codigo') || ''}"\n`;
                csvContent += `Corpo H√≠drico,"${formData.get('corpoHidrico') || ''}"\n`;
                csvContent += `Munic√≠pio,"${formData.get('municipio') || ''}"\n`;
                csvContent += `Bairro,"${formData.get('bairro') || ''}"\n`;
                csvContent += `Data da Visita,"${formData.get('dataVisita') || ''}"\n`;
                csvContent += `Regi√£o Hidrogr√°fica,"${formData.get('regiaoHidrografica') || ''}"\n`;
                csvContent += `T√©cnica Social,"${formData.get('tecnicaSocial') || ''}"\n`;
                csvContent += `Encarregados,"${formData.get('encarregados') || ''}"\n`;
                csvContent += `Agentes Socioambientais,"${(formData.get('agentesSocioambientais') || '').replace(/"/g, '""')}"\n`;
                csvContent += `Comunidade no Entorno,"${formData.get('comunidadeEntorno') || ''}"\n`;
                csvContent += `Nome da Comunidade,"${formData.get('nomeComunidade') || ''}"\n`;
                csvContent += `Constru√ß√µes √†s Margens,"${formData.get('construcoesMargens') || ''}"\n`;
                csvContent += `Tipo de Constru√ß√£o,"${formData.get('tipoConstrucao') || ''}"\n`;
                csvContent += `Quantidade de Moradias,"${formData.get('quantidadeMoradias') || ''}"\n`;
                csvContent += `Observa√ß√µes Gerais,"${(formData.get('observacoesGerais') || '').replace(/"/g, '""')}"\n`;
                
                // Adicionar equipamentos detalhados
                if (equipamentos.escolas.length > 0) {
                    csvContent += '\n\nESCOLAS\n';
                    csvContent += 'Nome,Endere√ßo,Segmento,Quantidade de Fotos\n';
                    equipamentos.escolas.forEach(escola => {
                        csvContent += `"${escola.nome.replace(/"/g, '""')}","${escola.endereco.replace(/"/g, '""')}","${escola.segmento}","${escola.fotos.length}"\n`;
                    });
                }
                
                if (equipamentos.saude.length > 0) {
                    csvContent += '\n\nUNIDADES DE SA√öDE\n';
                    csvContent += 'Nome,Endere√ßo,Quantidade de Fotos\n';
                    equipamentos.saude.forEach(unidade => {
                        csvContent += `"${unidade.nome.replace(/"/g, '""')}","${unidade.endereco.replace(/"/g, '""')}","${unidade.fotos.length}"\n`;
                    });
                }
                
                if (equipamentos.transporte.length > 0) {
                    csvContent += '\n\nTRANSPORTE P√öBLICO\n';
                    csvContent += 'Linha,Empresa,Tipo,Quantidade de Fotos\n';
                    equipamentos.transporte.forEach(t => {
                        csvContent += `"${t.linha.replace(/"/g, '""')}","${t.empresa.replace(/"/g, '""')}","${t.tipo}","${t.fotos.length}"\n`;
                    });
                }

                if (equipamentos.lazer.length > 0) {
                    csvContent += '\n\n√ÅREAS DE LAZER\n';
                    csvContent += 'Nome,Endere√ßo,Descri√ß√£o,Quantidade de Fotos\n';
                    equipamentos.lazer.forEach(area => {
                        csvContent += `"${area.nome.replace(/"/g, '""')}","${area.endereco.replace(/"/g, '""')}","${area.descricao.replace(/"/g, '""')}","${area.fotos.length}"\n`;
                    });
                }

                if (equipamentos.religiosas.length > 0) {
                    csvContent += '\n\nINSTITUI√á√ïES RELIGIOSAS\n';
                    csvContent += 'Nome,Endere√ßo,Tipo,Quantidade de Fotos\n';
                    equipamentos.religiosas.forEach(inst => {
                        csvContent += `"${inst.nome.replace(/"/g, '""')}","${inst.endereco.replace(/"/g, '""')}","${inst.tipo}","${inst.fotos.length}"\n`;
                    });
                }

                if (equipamentos.associacoes.length > 0) {
                    csvContent += '\n\nASSOCIA√á√ïES DE MORADORES\n';
                    csvContent += 'Nome,Endere√ßo,Contato,Quantidade de Fotos\n';
                    equipamentos.associacoes.forEach(assoc => {
                        csvContent += `"${assoc.nome.replace(/"/g, '""')}","${assoc.endereco.replace(/"/g, '""')}","${assoc.contato.replace(/"/g, '""')}","${assoc.fotos.length}"\n`;
                    });
                }

                if (equipamentos.comercios.length > 0) {
                    csvContent += '\n\nCOM√âRCIOS LOCAIS\n';
                    csvContent += 'Nome,Endere√ßo,Tipo,Quantidade de Fotos\n';
                    equipamentos.comercios.forEach(com => {
                        csvContent += `"${com.nome.replace(/"/g, '""')}","${com.endereco.replace(/"/g, '""')}","${com.tipo}","${com.fotos.length}"\n`;
                    });
                }

                // Adicionar informa√ß√µes sobre fotos gerais
                if (uploadedPhotos.length > 0) {
                    csvContent += '\n\nFOTOS GERAIS\n';
                    csvContent += 'Nome do Arquivo,Data de Upload\n';
                    uploadedPhotos.forEach(foto => {
                        csvContent += `"${foto.name.replace(/"/g, '""')}","${new Date(foto.date).toLocaleDateString('pt-BR')}"\n`;
                    });
                }

                // Resumo estat√≠stico
                csvContent += '\n\nRESUMO ESTAT√çSTICO\n';
                csvContent += 'Tipo de Equipamento,Quantidade\n';
                csvContent += `Escolas,"${equipamentos.escolas.length}"\n`;
                csvContent += `Unidades de Sa√∫de,"${equipamentos.saude.length}"\n`;
                csvContent += `Linhas de Transporte,"${equipamentos.transporte.length}"\n`;
                csvContent += `√Åreas de Lazer,"${equipamentos.lazer.length}"\n`;
                csvContent += `Institui√ß√µes Religiosas,"${equipamentos.religiosas.length}"\n`;
                csvContent += `Associa√ß√µes de Moradores,"${equipamentos.associacoes.length}"\n`;
                csvContent += `Com√©rcios Locais,"${equipamentos.comercios.length}"\n`;
                csvContent += `Total de Equipamentos,"${Object.values(equipamentos).reduce((total, arr) => total + arr.length, 0)}"\n`;
                csvContent += `Fotos Gerais,"${uploadedPhotos.length}"\n`;
                
                const totalFotosEquipamentos = Object.values(equipamentos).reduce((total, arr) => 
                    total + arr.reduce((subtotal, item) => subtotal + (item.fotos ? item.fotos.length : 0), 0), 0
                );
                csvContent += `Fotos de Equipamentos,"${totalFotosEquipamentos}"\n`;
                csvContent += `Total de Fotos,"${uploadedPhotos.length + totalFotosEquipamentos}"\n`;
                
                // Gerar e baixar arquivo
                const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8' });
                const url = window.URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.style.display = 'none';
                a.href = url;
                const nomeArquivo = `Frente_${formData.get('codigo') || 'Nova'}_${(formData.get('corpoHidrico') || 'Dados').replace(/\s+/g, '_')}_Completo.csv`;
                a.download = nomeArquivo;
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                window.URL.revokeObjectURL(url);
                
                // Mostrar mensagem de sucesso
                const successDiv = document.createElement('div');
                successDiv.className = 'fixed top-4 right-4 bg-green-600 text-white px-6 py-3 rounded-lg shadow-lg z-50';
                successDiv.innerHTML = '‚úÖ Dados completos exportados para CSV com sucesso!';
                document.body.appendChild(successDiv);
                
                setTimeout(() => {
                    successDiv.remove();
                }, 3000);
                
            } catch (error) {
                console.error('Erro ao exportar CSV:', error);
                alert('Erro ao exportar dados. Tente novamente.');
            }
        }

        function gerarWordFrenteAtual() {
            const form = document.getElementById('frenteForm');
            const formData = new FormData(form);
            
            // Verificar se h√° dados no formul√°rio
            if (!formData.get('codigo') && !formData.get('corpoHidrico')) {
                alert('‚ö†Ô∏è Preencha pelo menos o c√≥digo e corpo h√≠drico para gerar o documento.');
                return;
            }
            
            try {
                // Criar objeto frente tempor√°rio com dados do formul√°rio
                const frenteTemp = {
                    codigo: formData.get('codigo') || 'Nova Frente',
                    corpoHidrico: formData.get('corpoHidrico') || 'N√£o informado',
                    municipio: formData.get('municipio') || 'N√£o informado',
                    bairro: formData.get('bairro') || 'N√£o informado',
                    dataVisita: formData.get('dataVisita') || new Date().toISOString().split('T')[0],
                    tecnicaSocial: formData.get('tecnicaSocial') || 'N√£o informado',
                    comunidadeEntorno: formData.get('comunidadeEntorno') || 'nao',
                    nomeComunidade: formData.get('nomeComunidade') || ''
                };
                
                // Gerar documento
                gerarWordFrente(frenteTemp, formData);
                
                // Mostrar mensagem de sucesso
                const successDiv = document.createElement('div');
                successDiv.className = 'fixed top-4 right-4 bg-blue-600 text-white px-6 py-3 rounded-lg shadow-lg z-50';
                successDiv.innerHTML = '‚úÖ Documento gerado com sucesso!';
                document.body.appendChild(successDiv);
                
                setTimeout(() => {
                    successDiv.remove();
                }, 3000);
                
            } catch (error) {
                console.error('Erro ao gerar documento:', error);
                alert('Erro ao gerar documento. Verifique os dados e tente novamente.');
            }
        }

        function logout() {
            if (confirm('Tem certeza que deseja sair do sistema?')) {
                alert('Logout realizado com sucesso!');
            }
        }

        // Inicializa√ß√£o
        document.addEventListener('DOMContentLoaded', function() {
            showSection('dashboard');
            atualizarDashboard();
        });
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'98e98b1996e3f1c9',t:'MTc2MDQ3MDc3Mi4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
